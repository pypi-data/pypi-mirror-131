(self["webpackChunkunmanic_frontend"]=self["webpackChunkunmanic_frontend"]||[]).push([[52],{9052:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>ce});var l=s(3673),o=s(2323);const a={class:"q-pa-none"},n={class:"row"},i={class:"col q-ma-sm"},r={class:"q-pa-md",style:{"max-width":"500px"}},u={class:"q-mb-none"},c={class:"q-gutter-sm"},d={class:"q-mb-none"},m={class:"q-gutter-sm"},h={class:"text-weight-bold"},p={class:"text-weight-bold"},w={class:"text-grey-8 q-gutter-xs"},k={class:"text-h6"},g={class:"row items-center justify-end"},b={class:"q-mb-none"},f={class:"q-gutter-sm"},y={key:0},W={class:"row"},v={class:"col-6 text-center"},q=(0,l.Uk)(" Library "),_={class:"col-6 text-center"},$=(0,l.Uk)(" Plugins ");function C(e,t,s,C,T,x){const L=(0,l.up)("q-skeleton"),V=(0,l.up)("q-input"),Q=(0,l.up)("q-slider"),S=(0,l.up)("q-separator"),Z=(0,l.up)("q-icon"),P=(0,l.up)("q-avatar"),U=(0,l.up)("q-item-section"),j=(0,l.up)("q-item-label"),z=(0,l.up)("q-btn"),O=(0,l.up)("q-item"),H=(0,l.up)("draggable"),I=(0,l.up)("q-list"),D=(0,l.up)("q-space"),B=(0,l.up)("q-tooltip"),E=(0,l.up)("q-bar"),A=(0,l.up)("q-card-section"),F=(0,l.up)("q-select"),J=(0,l.up)("q-time"),N=(0,l.up)("q-popup-proxy"),G=(0,l.up)("q-card-actions"),K=(0,l.up)("q-card"),M=(0,l.up)("q-dialog"),R=(0,l.up)("q-form"),X=(0,l.up)("q-page"),Y=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.j4)(X,{padding:""},{default:(0,l.w5)((()=>[(0,l.Wm)("div",a,[(0,l.Wm)("div",n,[(0,l.Wm)("div",i,[(0,l.Wm)("div",r,[(0,l.Wm)(R,{onSubmit:x.save,class:"q-gutter-md"},{default:(0,l.w5)((()=>[(0,l.Wm)("h5",u,(0,o.zw)(e.$t("components.settings.workers.workerCount")),1),(0,l.Wm)("div",c,[null===T.workerCount?((0,l.wg)(),(0,l.j4)(L,{key:0,type:"QInput"})):(0,l.kq)("",!0),null!==T.workerCount?((0,l.wg)(),(0,l.j4)(V,{key:1,readonly:"",outlined:"",color:"primary",modelValue:T.workerCount,"onUpdate:modelValue":t[1]||(t[1]=e=>T.workerCount=e),label:e.$t("components.settings.workers.workerCount"),placeholder:T.workerCount},null,8,["modelValue","label","placeholder"])):(0,l.kq)("",!0),null===T.workerCount?((0,l.wg)(),(0,l.j4)(L,{key:2,type:"QSlider"})):(0,l.kq)("",!0),null!==T.workerCount?((0,l.wg)(),(0,l.j4)(Q,{key:3,modelValue:T.workerCount,"onUpdate:modelValue":t[2]||(t[2]=e=>T.workerCount=e),min:0,max:12,color:"primary"},null,8,["modelValue"])):(0,l.kq)("",!0)]),(0,l.Wm)(S,{class:"q-my-lg"}),(0,l.Wm)("h5",d,(0,o.zw)(e.$t("components.settings.workers.schedule")),1),(0,l.Wm)("div",m,[null===T.cachePath?((0,l.wg)(),(0,l.j4)(L,{key:0,type:"text"})):(0,l.kq)("",!0),(0,l.Wm)(I,{bordered:"",separator:"",class:"rounded-borders"},{default:(0,l.w5)((()=>[(0,l.Wm)(H,(0,l.dG)({class:"schedule-list-group","item-key":"order",tag:"transition-group","component-data":{tag:"ul",name:"flip-list",type:"transition"},modelValue:T.schedules,"onUpdate:modelValue":t[3]||(t[3]=e=>T.schedules=e)},x.dragOptions),{item:(0,l.w5)((({element:e,index:t})=>[(0,l.Wm)(O,{key:t,class:"q-pa-none rounded-borders","active-class":"schedule-list-item"},{default:(0,l.w5)((()=>[(0,l.Wm)(U,{avatar:"",class:"q-px-sm q-mx-sm"},{default:(0,l.w5)((()=>[(0,l.Wm)(P,{rounded:""},{default:(0,l.w5)((()=>[(0,l.Wm)(Z,{name:"drag_handle",class:"",style:{"max-width":"30px"}})])),_:1})])),_:1}),(0,l.Wm)(S,{inset:"",vertical:"",class:"q-mr-sm"}),(0,l.Wm)(U,{class:"q-px-sm q-mx-sm"},{default:(0,l.w5)((()=>[(0,l.Wm)(j,{lines:"1"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e.repetitionLabel)+" @ "+(0,o.zw)(e.scheduleTime),1)])),_:2},1024),"count"===e.scheduleTask?((0,l.wg)(),(0,l.j4)(j,{key:0,caption:"",lines:"2"},{default:(0,l.w5)((()=>[(0,l.Wm)("span",h,(0,o.zw)(e.scheduleTaskLabel),1),(0,l.Uk)(" = "+(0,o.zw)(e.scheduleWorkerCount),1)])),_:2},1024)):((0,l.wg)(),(0,l.j4)(j,{key:1,caption:"",lines:"2"},{default:(0,l.w5)((()=>[(0,l.Wm)("span",p,(0,o.zw)(e.scheduleTaskLabel),1)])),_:2},1024))])),_:2},1024),(0,l.Wm)(S,{inset:"",vertical:"",class:"q-mx-sm"}),(0,l.Wm)(U,{center:"",side:""},{default:(0,l.w5)((()=>[(0,l.Wm)("div",w,[(0,l.Wm)(z,{size:"12px",flat:"",dense:"",round:"",icon:"delete",onClick:e=>x.deleteSchedule(t)},null,8,["onClick"])])])),_:2},1024)])),_:2},1024)])),_:1},16,["modelValue"])])),_:1}),(0,l.Wm)(E,{class:"bg-transparent"},{default:(0,l.w5)((()=>[(0,l.Wm)(D),(0,l.Wm)(z,{round:"",flat:"",color:"primary",icon:"add",onClick:t[4]||(t[4]=e=>T.newSchedule=!0)},{default:(0,l.w5)((()=>[(0,l.Wm)(B,{class:"bg-white text-primary"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e.$t("tooltips.add")),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(M,{modelValue:T.newSchedule,"onUpdate:modelValue":t[10]||(t[10]=e=>T.newSchedule=e),persistent:""},{default:(0,l.w5)((()=>[(0,l.Wm)(K,{style:{"min-width":"350px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(A,null,{default:(0,l.w5)((()=>[(0,l.Wm)("div",k,(0,o.zw)(e.$t("components.settings.workers.newScheduledEvent")),1)])),_:1}),(0,l.Wm)(A,{class:"q-pt-none"},{default:(0,l.w5)((()=>[(0,l.Wm)(F,{filled:"",modelValue:T.repetition,"onUpdate:modelValue":t[5]||(t[5]=e=>T.repetition=e),options:T.repetitionOptions,label:e.$t("components.settings.workers.repetition")},null,8,["modelValue","options","label"])])),_:1}),(0,l.Wm)(A,{class:"q-pt-none"},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{filled:"",modelValue:T.scheduleTime,"onUpdate:modelValue":t[7]||(t[7]=e=>T.scheduleTime=e),mask:"time"},{append:(0,l.w5)((()=>[(0,l.Wm)(Z,{name:"access_time",class:"cursor-pointer"},{default:(0,l.w5)((()=>[(0,l.Wm)(N,{"transition-show":"scale","transition-hide":"scale"},{default:(0,l.w5)((()=>[(0,l.Wm)(J,{modelValue:T.scheduleTime,"onUpdate:modelValue":t[6]||(t[6]=e=>T.scheduleTime=e)},{default:(0,l.w5)((()=>[(0,l.Wm)("div",g,[(0,l.wy)((0,l.Wm)(z,{label:e.$t("navigation.close"),color:"primary",flat:""},null,8,["label"]),[[Y]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,l.Wm)(A,{class:"q-pt-none"},{default:(0,l.w5)((()=>[(0,l.Wm)(F,{filled:"",modelValue:T.scheduleTask,"onUpdate:modelValue":t[8]||(t[8]=e=>T.scheduleTask=e),options:T.scheduleTaskOptions,label:e.$t("components.settings.workers.task")},null,8,["modelValue","options","label"])])),_:1}),"count"===T.scheduleTask.value?((0,l.wg)(),(0,l.j4)(A,{key:0,class:"q-pt-none q-mt-md q-mx-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(Q,{modelValue:T.scheduleWorkerCount,"onUpdate:modelValue":t[9]||(t[9]=e=>T.scheduleWorkerCount=e),min:0,max:12,label:"","label-value":"Worker count: "+T.scheduleWorkerCount,"label-always":"",color:"primary"},null,8,["modelValue","label-value"])])),_:1})):(0,l.kq)("",!0),(0,l.Wm)(G,{align:"right",class:"text-primary"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(z,{flat:"",label:e.$t("navigation.cancel")},null,8,["label"]),[[Y]]),(0,l.wy)((0,l.Wm)(z,{onClick:x.addNewScheduledEvent,flat:"",label:e.$t("components.settings.workers.addEvent")},null,8,["onClick","label"]),[[Y]])])),_:1})])),_:1})])),_:1},8,["modelValue"])]),(0,l.Wm)(S,{class:"q-my-lg"}),(0,l.Wm)("h5",b,(0,o.zw)(e.$t("components.settings.workers.path")),1),(0,l.Wm)("div",f,[null===T.cachePath?((0,l.wg)(),(0,l.j4)(L,{key:0,type:"QInput"})):((0,l.wg)(),(0,l.j4)(V,{key:1,readonly:"",outlined:"",color:"primary",modelValue:T.cachePath,"onUpdate:modelValue":t[11]||(t[11]=e=>T.cachePath=e),label:e.$t("components.settings.workers.path"),placeholder:T.cachePath,onClick:x.updateLibraryWithDirectoryBrowser},{append:(0,l.w5)((()=>[(0,l.Wm)(Z,{onClick:x.updateLibraryWithDirectoryBrowser,class:"cursor-pointer",name:"folder_open"},null,8,["onClick"])])),_:1},8,["modelValue","label","placeholder","onClick"]))]),(0,l.Wm)("div",null,[(0,l.Wm)(z,{label:e.$t("navigation.submit"),type:"submit",color:"secondary"},null,8,["label"])])])),_:1},8,["onSubmit"])])])]),e.$q.platform.is.mobile?((0,l.wg)(),(0,l.j4)("div",y,[(0,l.Wm)(S,{class:"q-mb-lg"}),(0,l.Wm)("div",W,[(0,l.Wm)("div",v,[(0,l.Wm)(K,{flat:"",bordered:"",onClick:t[12]||(t[12]=t=>e.$router.push("/ui/settings-library")),class:"bg-grey-1 q-ma-xs"},{default:(0,l.w5)((()=>[(0,l.Wm)(z,{icon:"navigate_before",flat:""},{default:(0,l.w5)((()=>[q])),_:1})])),_:1})]),(0,l.Wm)("div",_,[(0,l.Wm)(K,{flat:"",bordered:"",onClick:t[13]||(t[13]=t=>e.$router.push("/ui/settings-plugins")),class:"bg-grey-1 q-ma-xs"},{default:(0,l.w5)((()=>[(0,l.Wm)(z,{"icon-right":"navigate_next",flat:""},{default:(0,l.w5)((()=>[$])),_:1})])),_:1})])])])):(0,l.kq)("",!0)])])),_:1})}var T=s(4190),x=s(1959),L=s(8825),V=s(5948),Q=s(1536),S=s(52),Z=s.n(S),P=s(470),U=s.n(P),j=s(7689);const z={name:"SettingsWorkers",components:{draggable:U()},setup(){(0,L.Z)();const{t:e}=(0,V.QT)();let t=null,s=(0,T.A)(e);function o(){t=s.init()}function a(){s.close()}(0,l.bv)((()=>{o()})),(0,l.Ah)((()=>{a()}))},data(){return{workerCount:(0,x.iH)(null),cachePath:(0,x.iH)(null),schedules:(0,x.iH)([]),newSchedule:(0,x.iH)(!1),repetition:(0,x.iH)(""),repetitionOptions:[{label:this.$t("components.settings.workers.scheduleLabels.daily"),value:"daily"},{label:this.$t("components.settings.workers.scheduleLabels.weekday"),value:"weekday"},{label:this.$t("components.settings.workers.scheduleLabels.weekend"),value:"weekend"},{label:this.$t("components.settings.workers.scheduleLabels.monday"),value:"monday"},{label:this.$t("components.settings.workers.scheduleLabels.tuesday"),value:"tuesday"},{label:this.$t("components.settings.workers.scheduleLabels.wednesday"),value:"wednesday"},{label:this.$t("components.settings.workers.scheduleLabels.thursday"),value:"thursday"},{label:this.$t("components.settings.workers.scheduleLabels.friday"),value:"friday"},{label:this.$t("components.settings.workers.scheduleLabels.saturday"),value:"saturday"},{label:this.$t("components.settings.workers.scheduleLabels.sunday"),value:"sunday"}],scheduleTime:(0,x.iH)("00:00"),scheduleTask:(0,x.iH)(""),scheduleTaskOptions:[{label:this.$t("components.settings.workers.scheduleLabels.count"),value:"count"},{label:this.$t("components.settings.workers.scheduleLabels.pause"),value:"pause"},{label:this.$t("components.settings.workers.scheduleLabels.resume"),value:"resume"}],scheduleWorkerCount:(0,x.iH)(1)}},methods:{updateLibraryWithDirectoryBrowser:function(){this.$q.dialog({component:Q.Z,componentProps:{dialogHeader:this.$t("headers.selectDirectory"),initialPath:this.cachePath,listType:"directories"}}).onOk((e=>{"undefined"!==typeof e.selectedPath&&null!==e.selectedPath&&(this.cachePath=e.selectedPath)})).onDismiss((()=>{}))},fetchSettings:function(){Z()({method:"get",url:(0,j.J4)("v2","settings/read")}).then((e=>{this.workerCount=e.data.settings.number_of_workers;let t=[];for(let s=0;s<e.data.settings.worker_event_schedules.length;s++){let l=e.data.settings.worker_event_schedules[s];t[t.length]={repetition:l.repetition,repetitionLabel:this.$t("components.settings.workers.scheduleLabels."+l.repetition),scheduleTime:l.schedule_time,scheduleTask:l.schedule_task,scheduleTaskLabel:this.$t("components.settings.workers.scheduleLabels."+l.schedule_task),scheduleWorkerCount:l.schedule_worker_count}}this.schedules=t,this.cachePath=e.data.settings.cache_path})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.failedToFetchSettings"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},save:function(){let e=[];for(let s=0;s<this.schedules.length;s++)e[e.length]={repetition:this.schedules[s].repetition,schedule_time:this.schedules[s].scheduleTime,schedule_task:this.schedules[s].scheduleTask,schedule_worker_count:this.schedules[s].scheduleWorkerCount};let t={settings:{number_of_workers:this.workerCount,cache_path:this.cachePath,worker_event_schedules:e}};Z()({method:"post",url:(0,j.J4)("v2","settings/write"),data:t}).then((e=>{this.fetchSettings(),this.$q.notify({color:"positive",position:"top",icon:"cloud_done",message:this.$t("notifications.saved"),timeout:200})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.failedToSaveSettings"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},addNewScheduledEvent:function(){"undefined"!==typeof this.repetition.value&&"undefined"!==typeof this.scheduleTask.value?this.schedules[this.schedules.length]={repetition:this.repetition.value,repetitionLabel:this.$t("components.settings.workers.scheduleLabels."+this.repetition.value),scheduleTime:this.scheduleTime,scheduleTask:this.scheduleTask.value,scheduleTaskLabel:this.$t("components.settings.workers.scheduleLabels."+this.scheduleTask.value),scheduleWorkerCount:this.scheduleWorkerCount}:this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.invalidWorkerEvent"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})},deleteSchedule:function(e){let t=[];for(let s=0;s<this.schedules.length;s++)s!==e&&(t[t.length]=this.schedules[s]);this.schedules=t}},created(){this.fetchSettings()},computed:{dragOptions(){return{animation:100,group:"scheduleOrder",disabled:!1,ghostClass:"ghost",direction:"vertical",delay:200,delayOnTouchOnly:!0}}}};var O=s(4379),H=s(5269),I=s(4103),D=s(4842),B=s(2064),E=s(5869),A=s(7011),F=s(3414),J=s(2035),N=s(5096),G=s(4554),K=s(2350),M=s(2165),R=s(846),X=s(2025),Y=s(8870),ee=s(6778),te=s(151),se=s(5589),le=s(8516),oe=s(3944),ae=s(7886),ne=s(9367),ie=s(677),re=s(7518),ue=s.n(re);z.render=C;const ce=z;ue()(z,"components",{QPage:O.Z,QForm:H.Z,QSkeleton:I.ZP,QInput:D.Z,QSlider:B.Z,QSeparator:E.Z,QList:A.Z,QItem:F.Z,QItemSection:J.Z,QAvatar:N.Z,QIcon:G.Z,QItemLabel:K.Z,QBtn:M.Z,QBar:R.Z,QSpace:X.Z,QTooltip:Y.Z,QDialog:ee.Z,QCard:te.Z,QCardSection:se.Z,QSelect:le.Z,QPopupProxy:oe.Z,QTime:ae.Z,QCardActions:ne.Z}),ue()(z,"directives",{ClosePopup:ie.Z})}}]);