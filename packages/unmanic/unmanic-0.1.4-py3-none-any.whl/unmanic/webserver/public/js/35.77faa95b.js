(self["webpackChunkunmanic_frontend"]=self["webpackChunkunmanic_frontend"]||[]).push([[35],{1035:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>jt});var s=o(3673),l=o(2323);const a={class:"q-pa-none"},n={class:"row"},r={class:"col q-ma-sm"},i={class:"row items-center no-wrap"},c={class:"col"},d={class:"text-h6 text-purple-10"},u={class:"col-auto"},m={class:"row"},p={key:0,class:"full-width row flex-center text-accent q-gutter-sm"},w={class:"row"},g={class:"col-12 col-md-6"},f={class:"q-ma-sm"},k={class:"col-12 col-md-6"},h={class:"q-ma-sm"};function W(e,t,o,W,_,v){const b=(0,s.up)("q-icon"),y=(0,s.up)("q-item-label"),q=(0,s.up)("q-item-section"),T=(0,s.up)("q-item"),Z=(0,s.up)("q-list"),Q=(0,s.up)("q-btn-dropdown"),$=(0,s.up)("q-card-section"),P=(0,s.up)("WorkerProgress"),z=(0,s.up)("q-card"),S=(0,s.up)("PendingTasks"),x=(0,s.up)("CompletedTasks"),C=(0,s.up)("q-page"),U=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(C,{padding:""},{default:(0,s.w5)((()=>[(0,s.Wm)("div",a,[(0,s.Wm)("div",n,[(0,s.Wm)("div",r,[(0,s.Wm)(z,null,{default:(0,s.w5)((()=>[(0,s.Wm)($,{class:"bg-grey-2"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",i,[(0,s.Wm)("div",c,[(0,s.Wm)("div",d,[(0,s.Wm)(b,{name:"fas fa-spinner"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("headers.workers")),1)])]),(0,s.Wm)("div",u,[(0,s.Wm)(Q,{class:"q-ml-sm",color:0===Object.keys(W.workerProgressList).length?"grey-7":"secondary","disable-main-btn":0===Object.keys(W.workerProgressList).length,label:e.$t("navigation.options")},{default:(0,s.w5)((()=>[(0,s.Wm)(Z,null,{default:(0,s.w5)((()=>[(0,s.wy)((0,s.Wm)(T,{clickable:"",onClick:t[1]||(t[1]=e=>v.pauseAllWorkers())},{default:(0,s.w5)((()=>[(0,s.Wm)(q,null,{default:(0,s.w5)((()=>[(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(b,{name:"pause"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.workers.pauseAllWorkers")),1)])),_:1})])),_:1})])),_:1},512),[[U]]),(0,s.wy)((0,s.Wm)(T,{clickable:"",onClick:t[2]||(t[2]=e=>v.resumeAllWorkers())},{default:(0,s.w5)((()=>[(0,s.Wm)(q,null,{default:(0,s.w5)((()=>[(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(b,{name:"play_arrow"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.workers.resumeAllWorkers")),1)])),_:1})])),_:1})])),_:1},512),[[U]])])),_:1})])),_:1},8,["color","disable-main-btn","label"])])])])),_:1}),(0,s.Wm)($,null,{default:(0,s.w5)((()=>[(0,s.Wm)("div",m,[0===Object.keys(W.workerProgressList).length?((0,s.wg)(),(0,s.j4)("div",p,[(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.workers.listEmpty")),1)])),_:1})])):(0,s.kq)("",!0),((0,s.wg)(!0),(0,s.j4)(s.HY,null,(0,s.Ko)(W.workerProgressList,((e,t)=>((0,s.wg)(),(0,s.j4)(P,(0,s.dG)({key:t},e),null,16)))),128))])])),_:1})])),_:1})])]),(0,s.Wm)("div",w,[(0,s.Wm)("div",g,[(0,s.Wm)("div",f,[(0,s.Wm)(S,W.pendingTasksData,null,16)])]),(0,s.Wm)("div",k,[(0,s.Wm)("div",h,[(0,s.Wm)(x,W.completedTasksData,null,16)])])])])])),_:1})}o(71);const _=(0,s.HX)("data-v-3e692616");(0,s.dD)("data-v-3e692616");const v={class:"row items-center no-wrap"},b={class:"col"},y={key:0,class:"text-h8 text-primary"},q={key:1,class:"text-h8 text-primary"},T={class:"col-auto"},Z={class:"row"},Q={class:"row"},$=(0,s.Wm)("div",{class:"column q-ml-sm"},"ETC:",-1),P={class:"column q-ml-lg"},z={class:"row items-center no-wrap"},S={class:"col"},x={class:"text-h6 text-primary"},C={class:"col-auto"},U={class:"row"},L={class:"row"};(0,s.Cn)();const D=_(((e,t,o,a,n,r)=>{const i=(0,s.up)("q-tooltip"),c=(0,s.up)("q-btn"),d=(0,s.up)("q-card-section"),u=(0,s.up)("q-separator"),m=(0,s.up)("q-avatar"),p=(0,s.up)("q-circular-progress"),w=(0,s.up)("q-item-label"),g=(0,s.up)("q-item-section"),f=(0,s.up)("q-item"),k=(0,s.up)("q-list"),h=(0,s.up)("WorkerProgressStatus"),W=(0,s.up)("WorkerProgressLog"),D=(0,s.up)("q-card"),j=(0,s.up)("q-dialog"),I=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(D,{inline:"",style:{width:"370px"},class:"worker-progress-card"},{default:_((()=>[(0,s.Wm)(d,{class:"",maxlength:"2"},{default:_((()=>[(0,s.Wm)("div",v,[(0,s.Wm)("div",b,[e.label.length<50?((0,s.wg)(),(0,s.j4)("div",y,(0,l.zw)(e.label),1)):((0,s.wg)(),(0,s.j4)("div",q,(0,l.zw)(e.label.substring(0,48)+".."),1))]),(0,s.Wm)("div",T,[(0,s.Wm)(c,{onClick:t[1]||(t[1]=t=>e.workerProgressPopup=!0),color:"grey-7",dense:"",round:"",flat:"",icon:"open_in_full"},{default:_((()=>[(0,s.Wm)(i,{class:"bg-white text-primary"},{default:_((()=>[(0,s.Uk)((0,l.zw)(e.$t("navigation.showMore")),1)])),_:1})])),_:1})])])])),_:1}),(0,s.Wm)(u),(0,s.Wm)("div",Z,[(0,s.Wm)(d,{class:"q-pb-none col q-pb-none justify-center full-height full-width text-center"},{default:_((()=>[(0,s.Wm)(p,{indeterminate:e.indeterminate,"show-value":"",value:e.progress,size:"90px",thickness:.2,color:e.color,"center-color":"grey-3","track-color":"grey-7","font-size":"10px",class:"q-ma-md"},{default:_((()=>[(0,s.Wm)(m,{size:"60px"},{default:_((()=>[(0,s.Uk)((0,l.zw)(e.progressText),1)])),_:1})])),_:1},8,["indeterminate","value","thickness","color"])])),_:1}),(0,s.Wm)(d,{class:"q-pb-none col-7"},{default:_((()=>[(0,s.Wm)(k,{bordered:"",padding:""},{default:_((()=>[(0,s.Wm)(f,null,{default:_((()=>[(0,s.Wm)(g,null,{default:_((()=>[(0,s.Wm)(w,null,{default:_((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.workers.stateLabel")),1)])),_:1}),(0,s.Wm)(w,{caption:""},{default:_((()=>[(0,s.Uk)((0,l.zw)(e.state),1)])),_:1})])),_:1})])),_:1}),(0,s.Wm)(f,null,{default:_((()=>[(0,s.Wm)(g,null,{default:_((()=>[(0,s.Wm)(w,null,{default:_((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.workers.currentRunnerLabel")),1)])),_:1}),(0,s.Wm)(w,{caption:""},{default:_((()=>[(0,s.Uk)((0,l.zw)(e.currentRunner),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})]),(0,s.Wm)(d,{class:"q-pt-sm"},{default:_((()=>[(0,s.Wm)("div",Q,[$,(0,s.Wm)("div",P,(0,l.zw)(e.etc),1),(0,s.Wm)(i,{class:"bg-white text-primary"},{default:_((()=>[(0,s.Uk)((0,l.zw)(e.$t("tooltips.etc")),1)])),_:1})])])),_:1}),(0,s.Wm)(d,{class:"q-pa-none"},{default:_((()=>[(0,s.Wm)(j,{modelValue:e.workerProgressPopup,"onUpdate:modelValue":t[2]||(t[2]=t=>e.workerProgressPopup=t),"full-width":"","full-height":""},{default:_((()=>[(0,s.Wm)(D,null,{default:_((()=>[(0,s.Wm)(d,{class:"bg-grey-2"},{default:_((()=>[(0,s.Wm)("div",z,[(0,s.Wm)("div",S,[(0,s.Wm)("div",x,(0,l.zw)(e.label),1)]),(0,s.Wm)("div",C,[(0,s.wy)((0,s.Wm)(c,{color:"grey-7",dense:"",round:"",flat:"",icon:"close_fullscreen"},{default:_((()=>[(0,s.Wm)(i,{class:"bg-white text-primary"},{default:_((()=>[(0,s.Uk)((0,l.zw)(e.$t("tooltips.close")),1)])),_:1})])),_:1},512),[[I]])])])])),_:1}),(0,s.Wm)(d,{class:"q-pt-none"},{default:_((()=>[(0,s.Wm)("div",U,[(0,s.Wm)(d,{class:"col-12 col-md-7"},{default:_((()=>[(0,s.Wm)(h,{id:e.id,state:e.state,currentRunner:e.currentRunner,startTime:e.startTime,totalProcTime:e.totalProcTime,paused:e.paused,idle:e.idle},null,8,["id","state","currentRunner","startTime","totalProcTime","paused","idle"])])),_:1}),(0,s.Wm)(d,{class:"col-12 col-md q-pb-none justify-center full-height full-width text-center"},{default:_((()=>[(0,s.Wm)(p,{indeterminate:e.indeterminate,"show-value":"",value:e.progress,size:"90px",thickness:.2,color:e.color,"center-color":"grey-3","track-color":"grey-7","font-size":"10px",class:"q-ma-md"},{default:_((()=>[(0,s.Wm)(m,{size:"60px"},{default:_((()=>[(0,s.Uk)((0,l.zw)(e.progressText),1)])),_:1})])),_:1},8,["indeterminate","value","thickness","color"])])),_:1})]),(0,s.Wm)("div",L,[(0,s.Wm)(d,{class:"col"},{default:_((()=>[(0,s.Wm)(W,{workerLog:e.workerLog},null,8,["workerLog"])])),_:1})])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})}));var j=o(1959);const I={class:"row items-center no-wrap"},H={class:"col"},R={class:"text-h6 text-grey-8"},B={class:"col-auto"};function A(e,t,o,a,n,r){const i=(0,s.up)("q-icon"),c=(0,s.up)("q-item-label"),d=(0,s.up)("q-item-section"),u=(0,s.up)("q-item"),m=(0,s.up)("q-separator"),p=(0,s.up)("q-list"),w=(0,s.up)("q-btn-dropdown"),g=(0,s.up)("q-card-section"),f=(0,s.up)("q-card"),k=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(f,null,{default:(0,s.w5)((()=>[(0,s.Wm)(g,{class:"bg-grey-2 q-pa-sm"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",I,[(0,s.Wm)("div",H,[(0,s.Wm)("div",R,(0,l.zw)(e.$t("components.workers.status")),1)]),(0,s.Wm)("div",B,[(0,s.Wm)(w,{class:"q-ml-sm",color:"secondary",label:e.$t("navigation.options")},{default:(0,s.w5)((()=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[o.paused?(0,s.wy)(((0,s.wg)(),(0,s.j4)(u,{key:0,clickable:"",onClick:t[1]||(t[1]=e=>r.resumeWorker())},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"play_arrow"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.workers.resumeWorker")),1)])),_:1})])),_:1})])),_:1},512)),[[k]]):(0,s.wy)(((0,s.wg)(),(0,s.j4)(u,{key:1,clickable:"",onClick:t[2]||(t[2]=e=>r.pauseWorker())},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"pause"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.workers.pauseWorker")),1)])),_:1})])),_:1})])),_:1},512)),[[k]]),(0,s.Wm)(m),(0,s.wy)((0,s.Wm)(u,{clickable:"",onClick:t[3]||(t[3]=e=>r.terminateWorkerPrompt())},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"fas fa-skull-crossbones"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.workers.terminateWorker")),1)])),_:1})])),_:1})])),_:1},512),[[k]])])),_:1})])),_:1},8,["label"])])])])),_:1}),(0,s.Wm)(m),(0,s.Wm)(p,{bordered:"",padding:""},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.workers.stateLabel")),1)])),_:1}),(0,s.Wm)(c,{caption:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(o.state),1)])),_:1})])),_:1})])),_:1}),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.workers.currentRunnerLabel")),1)])),_:1}),(0,s.Wm)(c,{caption:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(o.currentRunner),1)])),_:1})])),_:1})])),_:1}),(0,s.Wm)(u,{class:"worker-progress-card-state-t-start"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.workers.startTimeLabel")),1)])),_:1}),(0,s.Wm)(c,{caption:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(o.startTime),1)])),_:1})])),_:1})])),_:1}),(0,s.Wm)(u,{class:"worker-progress-card-state-t-total"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.workers.totalProcessingTimeLabel")),1)])),_:1}),(0,s.Wm)(c,{caption:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(o.totalProcTime),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}var N=o(52),J=o.n(N),M=o(7689);const V={setup(){return{}},props:{id:{type:String},state:{type:String,default:"Waiting for another task..."},currentRunner:{type:String,default:""},startTime:{type:String,default:""},totalProcTime:{type:String,default:""},idle:{type:Boolean},paused:{type:Boolean}},methods:{pauseWorker:function(){let e={worker_id:this.id};J()({method:"post",url:(0,M.J4)("v2","workers/worker/pause"),data:e}).then((e=>{this.$q.notify({color:"positive",position:"top",message:this.$t("components.workers.workerPaused"),icon:"check_circle",actions:[{icon:"close",color:"white"}]})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("components.workers.workerPausedFailed"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},resumeWorker:function(){let e={worker_id:this.id};J()({method:"post",url:(0,M.J4)("v2","workers/worker/resume"),data:e}).then((e=>{this.$q.notify({color:"positive",position:"top",message:this.$t("components.workers.workerResumed"),icon:"check_circle",actions:[{icon:"close",color:"white"}]})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("components.workers.workerResumedFailed"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},terminateWorker:function(){let e={worker_id:this.id};J()({method:"delete",url:(0,M.J4)("v2","workers/worker/terminate"),data:e}).then((e=>{this.$q.notify({color:"positive",position:"top",message:this.$t("components.workers.workerTerminated"),icon:"check_circle",actions:[{icon:"close",color:"white"}]})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("components.workers.workerTerminationFailed"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},terminateWorkerPrompt:function(){this.idle?this.terminateWorker():this.$q.dialog({title:this.$t("headers.confirm"),message:this.$t("components.workers.terminateWorkerWarning"),cancel:!0,persistent:!0}).onOk((()=>{this.terminateWorker()}))}}};var E=o(151),O=o(5589),Y=o(2226),F=o(7011),K=o(3414),G=o(2035),X=o(2350),ee=o(4554),te=o(5869),oe=o(677),se=o(7518),le=o.n(se);V.render=A;const ae=V;le()(V,"components",{QCard:E.Z,QCardSection:O.Z,QBtnDropdown:Y.Z,QList:F.Z,QItem:K.Z,QItemSection:G.Z,QItemLabel:X.Z,QIcon:ee.Z,QSeparator:te.Z}),le()(V,"directives",{ClosePopup:oe.Z});const ne={class:"row items-center no-wrap"},re={class:"col"},ie={class:"text-h6 text-grey-8"},ce={class:"q-ma-none q-pa-none"};function de(e,t,o,a,n,r){const i=(0,s.up)("q-card-section"),c=(0,s.up)("q-separator"),d=(0,s.up)("q-card");return(0,s.wg)(),(0,s.j4)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{class:"bg-grey-2 q-pa-sm"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",ne,[(0,s.Wm)("div",re,[(0,s.Wm)("div",ie,(0,l.zw)(e.$t("components.workers.workerLog")),1)])])])),_:1}),(0,s.Wm)(c),(0,s.Wm)(i,{class:"bg-grey-1 q-pa-md"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.j4)(s.HY,null,(0,s.Ko)(o.workerLog,((e,t)=>((0,s.wg)(),(0,s.j4)("div",{key:t},[(0,s.Wm)("p",ce,(0,l.zw)(e),1)])))),128))])),_:1})])),_:1})}const ue={setup(){return{}},props:{workerLog:{type:Array}}};ue.render=de;const me=ue;le()(ue,"components",{QCard:E.Z,QCardSection:O.Z,QSeparator:te.Z});const pe=(0,s.aZ)({name:"WorkerProgress",components:{WorkerProgressStatus:ae,WorkerProgressLog:me},data(){return{workerProgressPopup:(0,j.iH)(!1)}},props:{id:{type:String,required:!0},label:{type:String,required:!0},name:{type:String,required:!0},progress:{type:Number,default:100},progressText:{type:String,default:""},etc:{type:String,default:""},color:{type:String,default:"warning"},state:{type:String,default:"Waiting for another task..."},currentRunner:{type:String,default:""},startTime:{type:String,default:""},totalProcTime:{type:String,default:""},indeterminate:{type:Boolean,default:!1},workerLog:{type:Array},idle:{type:Boolean},paused:{type:Boolean}}});var we=o(2165),ge=o(8870),fe=o(6122),ke=o(5096),he=o(6778);pe.render=D,pe.__scopeId="data-v-3e692616";const We=pe;le()(pe,"components",{QCard:E.Z,QCardSection:O.Z,QBtn:we.Z,QTooltip:ge.Z,QSeparator:te.Z,QCircularProgress:fe.Z,QAvatar:ke.Z,QList:F.Z,QItem:K.Z,QItemSection:G.Z,QItemLabel:X.Z,QDialog:he.Z}),le()(pe,"directives",{ClosePopup:oe.Z});const _e={class:"row items-center no-wrap"},ve={class:"col"},be={class:"text-h6 text-amber-10"},ye={class:"col-auto"},qe={class:"q-pa-md"},Te={class:"full-width row flex-center text-accent q-gutter-sm"},Ze={class:"full-width row flex-center text-accent q-gutter-sm"},Qe={class:"row items-center no-wrap"},$e={class:"col"},Pe={class:"text-h6 text-amber-10"},ze=(0,s.Uk)(" Pending Tasks "),Se={class:"col-auto"},xe={class:"q-pa-md"};function Ce(e,t,o,a,n,r){const i=(0,s.up)("q-icon"),c=(0,s.up)("q-tooltip"),d=(0,s.up)("q-btn"),u=(0,s.up)("q-card-section"),m=(0,s.up)("q-item-label"),p=(0,s.up)("q-item-section"),w=(0,s.up)("q-item"),g=(0,s.up)("q-list"),f=(0,s.up)("PendingTasksTable"),k=(0,s.up)("q-card"),h=(0,s.up)("q-dialog"),W=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(k,null,{default:(0,s.w5)((()=>[(0,s.Wm)(u,{class:"bg-grey-2"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",_e,[(0,s.Wm)("div",ve,[(0,s.Wm)("div",be,[(0,s.Wm)(i,{name:"fas fa-list-ul"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("headers.pendingTasks")),1)])]),(0,s.Wm)("div",ye,[(0,s.Wm)(d,{onClick:t[1]||(t[1]=t=>e.pendingTasksPopup=!0),color:"grey-7",dense:"",round:"",flat:"",icon:"open_in_full"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("navigation.showMore")),1)])),_:1})])),_:1})])])])),_:1}),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)("div",qe,[(0,s.Wm)(g,{separator:""},{default:(0,s.w5)((()=>[e.taskList?e.taskList.length?((0,s.wg)(!0),(0,s.j4)(s.HY,{key:2},(0,s.Ko)(e.taskList,(e=>((0,s.wg)(),(0,s.j4)(w,(0,s.dG)({key:e.id},e),{default:(0,s.w5)((()=>[(0,s.Wm)(p,{avatar:""},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"pending",class:"text-amber-10",style:{opacity:"0.8"}})])),_:1}),(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)))),128)):((0,s.wg)(),(0,s.j4)(w,{key:1},{default:(0,s.w5)((()=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)("div",Ze,[(0,s.Wm)(i,{size:"2em",name:"sentiment_dissatisfied"}),(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.pendingTasks.listEmpty")),1)])),_:1}),(0,s.Wm)(i,{size:"2em",name:"priority_high"})])])),_:1})])),_:1})):((0,s.wg)(),(0,s.j4)(w,{key:0},{default:(0,s.w5)((()=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)("div",Te,[(0,s.Wm)(i,{size:"2em",name:"sentiment_dissatisfied"}),(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.pendingTasks.listEmpty")),1)])),_:1}),(0,s.Wm)(i,{size:"2em",name:"priority_high"})])])),_:1})])),_:1}))])),_:1})])])),_:1}),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(h,{modelValue:e.pendingTasksPopup,"onUpdate:modelValue":t[2]||(t[2]=t=>e.pendingTasksPopup=t),"full-width":"","full-height":""},{default:(0,s.w5)((()=>[(0,s.Wm)(k,null,{default:(0,s.w5)((()=>[(0,s.Wm)(u,{class:"bg-grey-2"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",Qe,[(0,s.Wm)("div",$e,[(0,s.Wm)("div",Pe,[(0,s.Wm)(i,{name:"fas fa-list-ul"}),ze])]),(0,s.Wm)("div",Se,[(0,s.wy)((0,s.Wm)(d,{color:"grey-7",dense:"",round:"",flat:"",icon:"close_fullscreen"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("tooltips.close")),1)])),_:1})])),_:1},512),[[W]])])])])),_:1}),(0,s.Wm)(u,{class:"q-pt-none"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",xe,[(0,s.Wm)(f)])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})}const Ue={class:"q-pa-md"},Le={class:"full-width row flex-center text-accent q-gutter-sm"};function De(e,t,o,a,n,r){const i=(0,s.up)("q-icon"),c=(0,s.up)("q-input"),d=(0,s.up)("q-item-label"),u=(0,s.up)("q-item-section"),m=(0,s.up)("q-item"),p=(0,s.up)("q-separator"),w=(0,s.up)("q-list"),g=(0,s.up)("q-btn-dropdown"),f=(0,s.up)("q-table"),k=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)("div",Ue,[(0,s.Wm)(f,{title:"Pending Tasks",rows:a.rows,columns:a.columns,"row-key":"name",pagination:a.pagination,"onUpdate:pagination":t[2]||(t[2]=e=>a.pagination=e),loading:a.loading,filter:a.filter,onRequest:a.onRequest,"binary-state-sort":"","selected-rows-label":a.getSelectedString,selection:"multiple",selected:a.selected,"onUpdate:selected":t[3]||(t[3]=e=>a.selected=e)},{"top-left":(0,s.w5)((()=>[(0,s.Wm)(c,{filled:"",class:"shadow-1",dense:"",debounce:"300",color:"primary",modelValue:a.filter,"onUpdate:modelValue":t[1]||(t[1]=e=>a.filter=e),placeholder:e.$t("navigation.search")},{append:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"search"})])),_:1},8,["modelValue","placeholder"])])),"top-right":(0,s.w5)((()=>[(0,s.Wm)(g,{class:"q-ml-sm",color:"secondary",label:e.$t("navigation.options")},{default:(0,s.w5)((()=>[(0,s.Wm)(w,null,{default:(0,s.w5)((()=>[(0,s.wy)((0,s.Wm)(m,{clickable:"",onClick:a.rescanLibrary},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"search"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.pendingTasks.rescanLibrary")),1)])),_:1})])),_:1})])),_:1},8,["onClick"]),[[k]]),(0,s.Wm)(p),(0,s.wy)((0,s.Wm)(m,{clickable:"",onClick:a.moveToTop},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"arrow_upward"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.pendingTasks.moveToTop")),1)])),_:1})])),_:1})])),_:1},8,["onClick"]),[[k]]),(0,s.wy)((0,s.Wm)(m,{clickable:"",onClick:a.moveToBottom},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"arrow_downward"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.pendingTasks.moveToBottom")),1)])),_:1})])),_:1})])),_:1},8,["onClick"]),[[k]]),(0,s.Wm)(p),(0,s.wy)((0,s.Wm)(m,{clickable:"",onClick:a.deleteSelected},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"delete_outline"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.pendingTasks.removeSelected")),1)])),_:1})])),_:1})])),_:1},8,["onClick"]),[[k]])])),_:1})])),_:1},8,["label"])])),"no-data":(0,s.w5)((()=>[(0,s.Wm)("div",Le,[(0,s.Wm)(i,{size:"2em",name:"sentiment_dissatisfied"}),(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.pendingTasks.listEmpty")),1)])),_:1}),(0,s.Wm)(i,{size:"2em",name:"priority_high"})])])),_:1},8,["rows","columns","pagination","loading","filter","onRequest","selected-rows-label","selected"])])}var je=o(8825);const Ie=[{name:"id",label:"Name",required:!0,align:"left",field:e=>e.name,format:e=>`${e}`,sortable:!1}],He={setup(){const e=(0,je.Z)(),t=(0,j.iH)([]),o=(0,j.iH)(""),l=(0,j.iH)(!1),a=(0,j.iH)({sortBy:"priority",descending:!0,page:1,rowsPerPage:15,rowsNumber:10}),n=(0,j.iH)([]),r=(0,j.iH)(null);function i(){let e="";return 0!==n.value.length&&(e=`${n.value.length} record${n.value.length>1?"s":""} selected of ${t.value.length}`),e}function c(){J()({method:"get",url:(0,M.J4)("v1","pending/rescan")}).then((e=>{r.value=e.data})).catch((()=>{e.notify({color:"negative",position:"top",message:"An error was encountered while requesting a library rescan",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}function d(){if(0!==n.value.length){let e=[];for(let o=0;o<n.value.length;o++){let t=n.value[o];e[e.length]=t.id}let t={id_list:e,position:"top"};m(t)}else e.notify({color:"warning",position:"top",message:"Nothing selected",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}function u(){if(0!==n.value.length){let e=[];for(let o=0;o<n.value.length;o++){let t=n.value[o];e[e.length]=t.id}let t={id_list:e,position:"bottom"};m(t)}else e.notify({color:"warning",position:"top",message:"Nothing selected",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}function m(t){J()({method:"post",url:(0,M.J4)("v2","pending/reorder"),data:t}).then((e=>{r.value=e.data,w({pagination:a.value,filter:o.value})})).catch((()=>{e.notify({color:"negative",position:"top",message:"An error was encountered while requesting a task reorder",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}function p(){if(0!==n.value.length){let t=[];for(let e=0;e<n.value.length;e++){let o=n.value[e];t[t.length]=o.id}let s={id_list:t};J()({method:"delete",url:(0,M.J4)("v2","pending/tasks"),data:s}).then((e=>{w({pagination:a.value,filter:o.value})})).catch((()=>{e.notify({color:"negative",position:"top",message:"An error was encountered while requesting the selected tasks be deleted",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}else e.notify({color:"warning",position:"top",message:"Nothing selected",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}function w(o){const{page:s,rowsPerPage:n,sortBy:r,descending:i}=o.pagination,c=o.filter;l.value=!0;const d=0===n?a.value.rowsNumber:n,u=(s-1)*n;let m={start:u,length:d,search_value:c,order_by:r,order_direction:i?"desc":"asc"};J()({method:"post",url:(0,M.J4)("v2","pending/tasks"),data:m}).then((e=>{a.value.rowsNumber=e.data.recordsFiltered;const o=[];for(let t=0;t<e.data.results.length;t++){let s=e.data.results[t];o[t]={id:s.id,name:s.abspath,completed:s.finish_time,status:s.success?"Success":"Failed"}}t.value.splice(0,t.value.length,...o),a.value.page=s,a.value.rowsPerPage=n,a.value.sortBy=r,a.value.descending=i,l.value=!1})).catch((()=>{e.notify({color:"negative",position:"top",message:"An error was encountered while requesting the pending tasks list",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}return(0,s.bv)((()=>{w({pagination:a.value,filter:void 0})})),{selected:n,filter:o,loading:l,pagination:a,columns:Ie,rows:t,getSelectedString:i,onRequest:w,rescanLibrary:c,moveToTop:d,moveToBottom:u,deleteSelected:p,reloadTable(){w({pagination:a.value,filter:o.value})}}}};var Re=o(6429),Be=o(4842);He.render=De;const Ae=He;le()(He,"components",{QTable:Re.Z,QInput:Be.Z,QIcon:ee.Z,QBtnDropdown:Y.Z,QList:F.Z,QItem:K.Z,QItemSection:G.Z,QItemLabel:X.Z,QSeparator:te.Z}),le()(He,"directives",{ClosePopup:oe.Z});const Ne=(0,s.aZ)({name:"PendingTasks",components:{PendingTasksTable:Ae},data(){return{pendingTasksPopup:(0,j.iH)(!1)}},props:{taskList:{type:Array,required:!0}}});Ne.render=Ce;const Je=Ne;le()(Ne,"components",{QCard:E.Z,QCardSection:O.Z,QIcon:ee.Z,QBtn:we.Z,QTooltip:ge.Z,QList:F.Z,QItem:K.Z,QItemSection:G.Z,QItemLabel:X.Z,QDialog:he.Z}),le()(Ne,"directives",{ClosePopup:oe.Z});const Me={class:"row items-center no-wrap"},Ve={class:"col"},Ee={class:"text-h6 text-blue-10"},Oe={class:"col-auto"},Ye={class:"q-pa-md"},Fe={class:"full-width row flex-center text-accent q-gutter-sm"},Ke={class:"full-width row flex-center text-accent q-gutter-sm"},Ge={class:"row"},Xe={class:"column justify-center"},et={class:"column justify-center"},tt={class:"row items-center no-wrap"},ot={class:"col"},st={class:"text-h6 text-blue-10"},lt={class:"col-auto"},at={class:"q-pa-md"};function nt(e,t,o,a,n,r){const i=(0,s.up)("q-icon"),c=(0,s.up)("q-tooltip"),d=(0,s.up)("q-btn"),u=(0,s.up)("q-card-section"),m=(0,s.up)("q-item-label"),p=(0,s.up)("q-item-section"),w=(0,s.up)("q-item"),g=(0,s.up)("q-list"),f=(0,s.up)("CompletedTasksTable"),k=(0,s.up)("q-card"),h=(0,s.up)("q-dialog"),W=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(k,null,{default:(0,s.w5)((()=>[(0,s.Wm)(u,{class:"bg-grey-2"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",Me,[(0,s.Wm)("div",Ve,[(0,s.Wm)("div",Ee,[(0,s.Wm)(i,{name:"fas fa-list-ul"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("headers.completedTasks")),1)])]),(0,s.Wm)("div",Oe,[(0,s.Wm)(d,{onClick:t[1]||(t[1]=t=>e.completedTasksPopup=!0),color:"grey-7",dense:"",round:"",flat:"",icon:"open_in_full"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("navigation.showMore")),1)])),_:1})])),_:1})])])])),_:1}),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)("div",Ye,[(0,s.Wm)(g,{separator:""},{default:(0,s.w5)((()=>[e.taskList?e.taskList.length?((0,s.wg)(!0),(0,s.j4)(s.HY,{key:2},(0,s.Ko)(e.taskList,(e=>((0,s.wg)(),(0,s.j4)(w,(0,s.dG)({key:e.id},e),{default:(0,s.w5)((()=>[(0,s.Wm)(p,{avatar:""},{default:(0,s.w5)((()=>[e.success?((0,s.wg)(),(0,s.j4)(i,{key:0,name:"check_circle",class:"text-secondary",style:{opacity:"0.8"}})):((0,s.wg)(),(0,s.j4)(i,{key:1,name:"cancel",class:"text-negative",style:{opacity:"0.8"}}))])),_:2},1024),(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.label),1)])),_:2},1024)])),_:2},1024),(0,s.Wm)(p,{side:"",top:""},{default:(0,s.w5)((()=>[(0,s.Wm)("div",Ge,[(0,s.Wm)("div",Xe,[(0,s.Wm)(m,{caption:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.dateTimeSinceCompleted),1)])),_:2},1024)]),(0,s.Wm)("div",et,[(0,s.Wm)(i,{class:"q-ml-sm",name:"event",size:"18px"})])])])),_:2},1024)])),_:2},1040)))),128)):((0,s.wg)(),(0,s.j4)(w,{key:1},{default:(0,s.w5)((()=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)("div",Ke,[(0,s.Wm)(i,{size:"2em",name:"sentiment_dissatisfied"}),(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.completedTasks.listEmpty")),1)])),_:1}),(0,s.Wm)(i,{size:"2em",name:"priority_high"})])])),_:1})])),_:1})):((0,s.wg)(),(0,s.j4)(w,{key:0},{default:(0,s.w5)((()=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)("div",Fe,[(0,s.Wm)(i,{size:"2em",name:"sentiment_dissatisfied"}),(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.completedTasks.listEmpty")),1)])),_:1}),(0,s.Wm)(i,{size:"2em",name:"priority_high"})])])),_:1})])),_:1}))])),_:1})])])),_:1}),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(h,{modelValue:e.completedTasksPopup,"onUpdate:modelValue":t[2]||(t[2]=t=>e.completedTasksPopup=t),"full-width":"","full-height":""},{default:(0,s.w5)((()=>[(0,s.Wm)(k,null,{default:(0,s.w5)((()=>[(0,s.Wm)(u,{class:"bg-grey-2"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",tt,[(0,s.Wm)("div",ot,[(0,s.Wm)("div",st,[(0,s.Wm)(i,{name:"fas fa-list-ul"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("headers.completedTasks")),1)])]),(0,s.Wm)("div",lt,[(0,s.wy)((0,s.Wm)(d,{color:"grey-7",dense:"",round:"",flat:"",icon:"close_fullscreen"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("tooltips.close")),1)])),_:1})])),_:1},512),[[W]])])])])),_:1}),(0,s.Wm)(u,{class:"q-pt-none"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",at,[(0,s.Wm)(f)])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})}const rt={class:"q-pa-md"},it=(0,s.Uk)(" Add selected to Pending Tasks list "),ct=(0,s.Uk)(" Delete selected "),dt={class:"row"},ut={class:"row"},mt={class:"full-width row flex-center text-accent q-gutter-sm"};function pt(e,t,o,a,n,r){const i=(0,s.up)("q-icon"),c=(0,s.up)("q-input"),d=(0,s.up)("q-item-label"),u=(0,s.up)("q-item-section"),m=(0,s.up)("q-item"),p=(0,s.up)("q-separator"),w=(0,s.up)("q-list"),g=(0,s.up)("q-btn-dropdown"),f=(0,s.up)("q-badge"),k=(0,s.up)("q-td"),h=(0,s.up)("q-btn"),W=(0,s.up)("q-table"),_=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)("div",rt,[(0,s.Wm)(W,{title:"Completed Tasks",rows:a.rows,columns:a.columns,"row-key":"id",pagination:a.pagination,"onUpdate:pagination":t[2]||(t[2]=e=>a.pagination=e),loading:a.loading,filter:a.filter,onRequest:a.onRequest,"binary-state-sort":"","selected-rows-label":a.getSelectedString,selection:"multiple",selected:a.selected,"onUpdate:selected":t[3]||(t[3]=e=>a.selected=e)},{"top-left":(0,s.w5)((()=>[(0,s.Wm)(c,{filled:"",class:"shadow-1",dense:"",debounce:"300",color:"primary",modelValue:a.filter,"onUpdate:modelValue":t[1]||(t[1]=e=>a.filter=e),placeholder:e.$t("navigation.search")},{append:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"search"})])),_:1},8,["modelValue","placeholder"])])),"top-right":(0,s.w5)((()=>[(0,s.Wm)(g,{class:"q-ml-sm",color:"secondary",label:e.$t("navigation.options")},{default:(0,s.w5)((()=>[(0,s.Wm)(w,null,{default:(0,s.w5)((()=>[(0,s.wy)((0,s.Wm)(m,{clickable:"",onClick:a.addSelectedToPendingTaskList},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"add"}),it])),_:1})])),_:1})])),_:1},8,["onClick"]),[[_]]),(0,s.Wm)(p),(0,s.wy)((0,s.Wm)(m,{clickable:"",onClick:a.deleteSelected},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"delete_outline"}),ct])),_:1})])),_:1})])),_:1},8,["onClick"]),[[_]])])),_:1})])),_:1},8,["label"])])),"body-cell-task_success":(0,s.w5)((t=>[(0,s.Wm)(k,{props:t},{default:(0,s.w5)((()=>[(0,s.Wm)("div",dt,[t.row.status?((0,s.wg)(),(0,s.j4)(f,{key:0,color:"positive",class:"shadow-1"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("status.success")),1)])),_:1})):((0,s.wg)(),(0,s.j4)(f,{key:1,color:"negative",class:"shadow-1"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("status.failed")),1)])),_:1}))])])),_:2},1032,["props"])])),"body-cell-details":(0,s.w5)((t=>[(0,s.Wm)(k,{props:t},{default:(0,s.w5)((()=>[(0,s.Wm)("div",ut,[(0,s.Wm)(h,{onClick:e=>a.openDetailsDialog(t.row.id),color:"secondary",label:e.$t("components.completedTasks.details")},null,8,["onClick","label"])])])),_:2},1032,["props"])])),"no-data":(0,s.w5)((()=>[(0,s.Wm)("div",mt,[(0,s.Wm)(i,{size:"2em",name:"sentiment_dissatisfied"}),(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.completedTasks.listEmpty")),1)])),_:1}),(0,s.Wm)(i,{size:"2em",name:"priority_high"})])])),_:1},8,["rows","columns","pagination","loading","filter","onRequest","selected-rows-label","selected"])])}var wt=o(5616);const gt={printTimeSinceDate(e){let t=new Date,o=Math.floor((t-e)/1e3),s=Math.floor(o/60),l=Math.floor(s/60),a=Math.floor(l/24);return l-=24*a,s=s-24*a*60-60*l,o=o-24*a*60*60-60*l*60-60*s,"Days: "+a+" Hours: "+l+" Minutes: "+s+" Seconds: "+o},printTimeAsHoursMinsSeconds(e){e=Number(e);let t=Math.floor(e/3600),o=Math.floor(e%3600/60),s=Math.floor(e%3600%60),l=t>0?t+(1==t?" hour, ":" hours, "):"",a=o>0?o+(1==o?" minute, ":" minutes, "):"",n=s>0?s+(1==s?" second":" seconds"):"";return l+a+n},printDateTimeString(e){let t=new Date(0);return t.setUTCSeconds(e),wt.ZP.formatDate(t,"YYYY-MM-DD HH:mm:ss")}},ft={class:"row items-center no-wrap"},kt={class:"col-auto"},ht={class:"col"},Wt={class:"text-h6 text-secondary"},_t={class:"q-pt-md q-px-lg",style:{width:"2000px","max-width":"95vw"}},vt={class:"q-pa-md completed-task-details-dialog-content"};function bt(e,t,o,a,n,r){const i=(0,s.up)("q-tooltip"),c=(0,s.up)("q-btn"),d=(0,s.up)("q-icon"),u=(0,s.up)("q-card-section"),m=(0,s.up)("q-card"),p=(0,s.up)("q-dialog"),w=(0,s.Q2)("close-popup"),g=(0,s.Q2)("touch-swipe");return(0,s.wg)(),(0,s.j4)(p,{ref:"dialogRef",maximized:e.$q.platform.is.mobile,"transition-show":"slide-right","transition-hide":"slide-left","full-height":"",position:"left",onHide:r.onDialogHide},{default:(0,s.w5)((()=>[(0,s.wy)((0,s.Wm)(m,{style:{"max-width":"100vw"}},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{class:"bg-grey-2"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",ft,[(0,s.Wm)("div",kt,[(0,s.wy)((0,s.Wm)(c,{color:"grey-7",dense:"",round:"",flat:"",icon:"arrow_back"},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("tooltips.back")),1)])),_:1})])),_:1},512),[[w]])]),(0,s.Wm)("div",ht,[(0,s.Wm)("div",Wt,[(0,s.Wm)(d,{name:"description"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("headers.completedTaskDetails")),1)])])])])),_:1}),(0,s.Wm)(u,{class:"q-pt-none q-pa-none"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",_t,[(0,s.Wm)("div",vt,[((0,s.wg)(!0),(0,s.j4)(s.HY,null,(0,s.Ko)(e.taskDetails,((e,t)=>((0,s.wg)(),(0,s.j4)("p",{key:t,innerHTML:e},null,8,["innerHTML"])))),128))])])])),_:1})])),_:1},512),[[g,r.hide,void 0,{touch:!0,left:!0}]])])),_:1},8,["maximized","onHide"])}const yt={name:"CompletedTaskLogDialog",props:{completedTaskId:{type:String}},emits:["ok","hide","path"],methods:{show(){this.$refs.dialogRef.show()},hide(){this.$refs.dialogRef.hide()},onDialogHide(){this.$emit("hide")},fetchCompletedTaskLog:function(){let e={task_id:this.completedTaskId};J()({method:"post",url:(0,M.J4)("v2","history/task/log"),data:e}).then((e=>{this.taskDetails=e.data.command_log_lines})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("components.completedTasks.errorGettingDetails"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}},created(){this.fetchCompletedTaskLog()},data:function(){return{taskDetails:(0,j.iH)([])}}};var qt=o(8020);yt.render=bt;const Tt=yt;le()(yt,"components",{QDialog:he.Z,QCard:E.Z,QCardSection:O.Z,QBtn:we.Z,QTooltip:ge.Z,QIcon:ee.Z}),le()(yt,"directives",{TouchSwipe:qt.Z,ClosePopup:oe.Z});const Zt=[{name:"task_label",label:"Name",required:!0,align:"left",field:"name",sortable:!0},{name:"finish_time",label:"Completed",required:!0,align:"left",field:"dateTimeCompleted",sortable:!0},{name:"task_success",label:"Status",required:!0,align:"left",field:"status",sortable:!0},{name:"details",label:"Details",required:!0,align:"left",field:"id",sortable:!1}],Qt={setup(){const e=(0,je.Z)(),t=(0,j.iH)([]),o=(0,j.iH)(""),l=(0,j.iH)(!1),a=(0,j.iH)({sortBy:"finish_time",descending:!0,page:1,rowsPerPage:15,rowsNumber:10}),n=(0,j.iH)([]);function r(){let e="";return 0!==n.value.length&&(e=`${n.value.length} record${n.value.length>1?"s":""} selected of ${t.value.length}`),e}function i(){if(0!==n.value.length){let t=[];for(let e=0;e<n.value.length;e++){let o=n.value[e];t[t.length]=o.id}let s={id_list:t};J()({method:"delete",url:(0,M.J4)("v2","history/tasks"),data:s}).then((e=>{d({pagination:a.value,filter:o.value})})).catch((()=>{e.notify({color:"negative",position:"top",message:"An error was encountered while requesting the selected tasks be deleted",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}else e.notify({color:"warning",position:"top",message:"Nothing selected",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}function c(){if(0!==n.value.length){let t=[];for(let e=0;e<n.value.length;e++){let o=n.value[e];t[t.length]=o.id}let s={id_list:t};J()({method:"post",url:(0,M.J4)("v2","history/reprocess"),data:s}).then((e=>{d({pagination:a.value,filter:o.value})})).catch((()=>{e.notify({color:"negative",position:"top",message:"An error was encountered while requesting the selected tasks be added to the pending tasks list",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}else e.notify({color:"warning",position:"top",message:"Nothing selected",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}function d(o){const{page:s,rowsPerPage:n,sortBy:r,descending:i}=o.pagination,c=o.filter;l.value=!0;const d=0===n?a.value.rowsNumber:n,u=(s-1)*n;let m={start:u,length:d,search_value:c,order_by:r,order_direction:i?"desc":"asc"};J()({method:"post",url:(0,M.J4)("v2","history/tasks"),data:m}).then((e=>{a.value.rowsNumber=e.data.recordsFiltered;const o=[];for(let t=0;t<e.data.results.length;t++){let s=e.data.results[t];o[t]={id:s.id,name:s.task_label,dateTimeCompleted:gt.printDateTimeString(s.finish_time),status:s.task_success}}t.value.splice(0,t.value.length,...o),a.value.page=s,a.value.rowsPerPage=n,a.value.sortBy=r,a.value.descending=i,l.value=!1})).catch((()=>{e.notify({color:"negative",position:"top",message:"An error was encountered while requesting the completed tasks list",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}function u(t){console.log(t),e.dialog({component:Tt,componentProps:{completedTaskId:t}}).onOk((e=>{})).onDismiss((()=>{}))}return(0,s.bv)((()=>{d({pagination:a.value,filter:void 0})})),{selected:n,filter:o,loading:l,pagination:a,columns:Zt,rows:t,getSelectedString:r,onRequest:d,deleteSelected:i,addSelectedToPendingTaskList:c,openDetailsDialog:u}}};var $t=o(3884),Pt=o(9721);Qt.render=pt;const zt=Qt;le()(Qt,"components",{QTable:Re.Z,QInput:Be.Z,QIcon:ee.Z,QBtnDropdown:Y.Z,QList:F.Z,QItem:K.Z,QItemSection:G.Z,QItemLabel:X.Z,QSeparator:te.Z,QTd:$t.Z,QBadge:Pt.Z,QBtn:we.Z}),le()(Qt,"directives",{ClosePopup:oe.Z});const St=(0,s.aZ)({name:"CompletedTasks",components:{CompletedTasksTable:zt},data(){return{completedTasksPopup:(0,j.iH)(!1)}},props:{taskList:{type:Array,required:!0}}});St.render=nt;const xt=St;le()(St,"components",{QCard:E.Z,QCardSection:O.Z,QIcon:ee.Z,QBtn:we.Z,QTooltip:ge.Z,QList:F.Z,QItem:K.Z,QItemSection:G.Z,QItemLabel:X.Z,QDialog:he.Z}),le()(St,"directives",{ClosePopup:oe.Z});var Ct=o(5948),Ut=o(4190);const Lt={name:"Dashboard",components:{CompletedTasks:xt,WorkerProgress:We,PendingTasks:Je},setup(){const{t:e}=(0,Ct.QT)(),t=((0,je.Z)(),(0,j.iH)([])),o=(0,j.iH)({taskList:[]}),l=(0,j.iH)({taskList:[]});let a=null,n=(0,Ut.A)(e);function r(o){function s(e,t){let o=100-parseInt(e);return parseInt(t)/parseInt(e)*o}let l={};for(let t=0;t<o.length;t++){let a=o[t];if(l["worker-"+a.id]={indeterminate:!1,id:a.id,label:a.name,name:a.name,color:"warning",progress:100,progressText:"-",etc:"...",state:e("components.workers.state.waiting"),currentRunner:e("components.workers.currentRunner.none"),startTime:"",totalProcTime:"",workerLog:[],idle:a.idle,paused:a.paused},a.paused&&(l["worker-"+a.id].label="...",l["worker-"+a.id].color="negative",l["worker-"+a.id].progressText="...",l["worker-"+a.id].state=e("components.workers.state.paused")),!a.idle){l["worker-"+a.id].label=a.name+": "+a.current_file,l["worker-"+a.id].color="secondary",l["worker-"+a.id].state=e("components.workers.state.processing");let t=e("components.workers.currentRunner.indeterminate");if("object"===typeof a.runners_info&&null!==a.runners_info)for(const[e,s]of Object.entries(a.runners_info))"in_progress"===s.status&&(t=s.name);l["worker-"+a.id].currentRunner=t;let o=new Date(1e3*a.start_time);l["worker-"+a.id].startTime=gt.printDateTimeString(a.start_time),l["worker-"+a.id].totalProcTime=gt.printTimeSinceDate(o),l["worker-"+a.id].workerLog=a.worker_log_tail,"undefined"!==typeof a.subprocess.percent&&""!==a.subprocess.percent?(l["worker-"+a.id].progress=Number(a.subprocess.percent),l["worker-"+a.id].progressText=a.subprocess.percent+"%",l["worker-"+a.id].etc=gt.printTimeAsHoursMinsSeconds(s(a.subprocess.percent,a.subprocess.elapsed))):(l["worker-"+a.id].indeterminate=!0,l["worker-"+a.id].progressText="..."),a.paused&&(l["worker-"+a.id].indeterminate=!0,l["worker-"+a.id].color="negative",l["worker-"+a.id].state=e("components.workers.state.paused"))}}t.value=l}function i(e){let t,s=[];for(let o=0;o<e.results.length;o++)t=e.results[o],s[o]={id:e.results[o].id,priority:e.results[o].priority,label:e.results[o].label,status:e.results[o].status};o.value.taskList=s}function c(e){let t,o=[];for(let s=0;s<e.results.length;s++)t=e.results[s],o[s]={id:e.results[s].id,label:e.results[s].label,dateTimeCompleted:gt.printDateTimeString(e.results[s].finish_time),dateTimeSinceCompleted:e.results[s].human_readable_time,success:e.results[s].success};l.value.taskList=o}function d(){a=n.init();let e=n.serverId;n.addEventListener("open","start_dashboard_messages",(function(e){a.send(JSON.stringify({command:"start_workers_info",params:{}})),a.send(JSON.stringify({command:"start_pending_tasks_info",params:{}})),a.send(JSON.stringify({command:"start_completed_tasks_info",params:{}}))})),n.addEventListener("message","handle_dashboard_messages",(function(t){if("string"===typeof t.data){let o=JSON.parse(t.data);if(o.success)switch(null===e?e=o.server_id:o.server_id!==e&&(console.debug("Unmanic server has restarted. Reloading page..."),location.reload()),o.type){case"workers_info":r(o.data);break;case"pending_tasks":i(o.data);break;case"completed_tasks":c(o.data);break}else console.error("WebSocket Error: Received contained errors - "+t.data)}else console.error("WebSocket Error: Received data was not JSON - "+t.data)}))}function u(){n.close()}return(0,s.bv)((()=>{d()})),(0,s.Ah)((()=>{u()})),{workerProgressList:t,pendingTasksData:o,completedTasksData:l}},methods:{pauseAllWorkers:function(){J()({method:"post",url:(0,M.J4)("v2","workers/worker/pause/all"),data:{}}).then((e=>{this.$q.notify({color:"positive",position:"top",message:this.$t("components.workers.workerPaused"),icon:"check_circle",actions:[{icon:"close",color:"white"}]})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("components.workers.workerPausedFailed"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},resumeAllWorkers:function(){J()({method:"post",url:(0,M.J4)("v2","workers/worker/resume/all"),data:{}}).then((e=>{this.$q.notify({color:"positive",position:"top",message:this.$t("components.workers.workerResumed"),icon:"check_circle",actions:[{icon:"close",color:"white"}]})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("components.workers.workerResumedFailed"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}}};var Dt=o(4379);Lt.render=W;const jt=Lt;le()(Lt,"components",{QPage:Dt.Z,QCard:E.Z,QCardSection:O.Z,QIcon:ee.Z,QBtnDropdown:Y.Z,QList:F.Z,QItem:K.Z,QItemSection:G.Z,QItemLabel:X.Z}),le()(Lt,"directives",{ClosePopup:oe.Z})}}]);