(self["webpackChunkunmanic_frontend"]=self["webpackChunkunmanic_frontend"]||[]).push([[232],{7232:(e,l,t)=>{"use strict";t.r(l),t.d(l,{default:()=>K});var n=t(3673),a=t(2323);const r={class:"q-pa-none"},i={class:"row"},s={class:"col q-ma-sm"},o={class:"q-pa-md",style:{"max-width":"500px"}},c={class:"q-mb-none"},u={class:"q-gutter-sm"},d={class:"q-mb-none"},m={class:"q-gutter-sm"},y={key:2,class:"sub-setting"},b={class:"q-gutter-sm"},g={class:"q-gutter-sm"},p={class:"q-gutter-sm"},h={class:"q-mb-none"},S={class:"q-gutter-sm"},k={class:"q-mb-none"},w={class:"q-gutter-sm"},q={class:"q-mb-none"},_={class:"q-gutter-sm"},f={key:0},W={class:"row"},v=(0,n.Wm)("div",{class:"col-6 text-center"},null,-1),T={class:"col-6 text-center"},F=(0,n.Uk)(" Workers ");function V(e,l,t,V,L,$){const P=(0,n.up)("q-skeleton"),j=(0,n.up)("q-icon"),Q=(0,n.up)("q-input"),O=(0,n.up)("q-separator"),Z=(0,n.up)("q-toggle"),U=(0,n.up)("q-slider"),C=(0,n.up)("q-btn"),H=(0,n.up)("q-form"),M=(0,n.up)("q-card"),x=(0,n.up)("q-page");return(0,n.wg)(),(0,n.j4)(x,{padding:""},{default:(0,n.w5)((()=>[(0,n.Wm)("div",r,[(0,n.Wm)("div",i,[(0,n.Wm)("div",s,[(0,n.Wm)("div",o,[(0,n.Wm)(H,{onSubmit:$.save,class:"q-gutter-md"},{default:(0,n.w5)((()=>[(0,n.Wm)("h5",c,(0,a.zw)(e.$t("components.settings.library.pathConfiguration")),1),(0,n.Wm)("div",u,[null===L.libraryPath?((0,n.wg)(),(0,n.j4)(P,{key:0,type:"QInput"})):((0,n.wg)(),(0,n.j4)(Q,{key:1,readonly:"",outlined:"",color:"primary",modelValue:L.libraryPath,"onUpdate:modelValue":l[1]||(l[1]=e=>L.libraryPath=e),label:e.$t("components.settings.library.path"),placeholder:L.libraryPath,onClick:$.updateLibraryWithDirectoryBrowser},{append:(0,n.w5)((()=>[(0,n.Wm)(j,{onClick:$.updateLibraryWithDirectoryBrowser,class:"cursor-pointer",name:"folder_open"},null,8,["onClick"])])),_:1},8,["modelValue","label","placeholder","onClick"]))]),(0,n.Wm)(O,{class:"q-my-lg"}),(0,n.Wm)("h5",d,(0,a.zw)(e.$t("components.settings.library.libraryScanner")),1),(0,n.Wm)("div",m,[null===L.enableLibraryScanner?((0,n.wg)(),(0,n.j4)(P,{key:0,type:"QToggle"})):((0,n.wg)(),(0,n.j4)(Z,{key:1,modelValue:L.enableLibraryScanner,"onUpdate:modelValue":l[2]||(l[2]=e=>L.enableLibraryScanner=e),label:e.$t("components.settings.library.enableLibraryScanner")},null,8,["modelValue","label"])),L.enableLibraryScanner?((0,n.wg)(),(0,n.j4)("div",y,[(0,n.Wm)("div",b,[null===L.libraryScanSchedule?((0,n.wg)(),(0,n.j4)(P,{key:0,type:"QInput"})):(0,n.kq)("",!0),L.enableLibraryScanner&&null!==L.libraryScanSchedule?((0,n.wg)(),(0,n.j4)(Q,{key:1,outlined:"",type:"number",modelValue:L.libraryScanSchedule,"onUpdate:modelValue":l[3]||(l[3]=e=>L.libraryScanSchedule=e),label:e.$t("components.settings.library.libraryScannerSchedule"),"lazy-rules":"",rules:[l=>null!==l&&""!==l||e.$t("components.settings.library.libraryScannerScheduleNotValid"),l=>l>0||e.$t("components.settings.pleaseEnterAValidNumber")]},null,8,["modelValue","label","rules"])):(0,n.kq)("",!0)])])):(0,n.kq)("",!0)]),(0,n.Wm)("div",g,[null===L.runLibraryScanOnStart?((0,n.wg)(),(0,n.j4)(P,{key:0,type:"QToggle"})):(0,n.kq)("",!0),null!==L.runLibraryScanOnStart?((0,n.wg)(),(0,n.j4)(Z,{key:1,modelValue:L.runLibraryScanOnStart,"onUpdate:modelValue":l[4]||(l[4]=e=>L.runLibraryScanOnStart=e),label:e.$t("components.settings.library.runLibraryScanOnStart")},null,8,["modelValue","label"])):(0,n.kq)("",!0)]),(0,n.Wm)("div",p,[null===L.libraryScanFollowSymlinks?((0,n.wg)(),(0,n.j4)(P,{key:0,type:"QToggle"})):(0,n.kq)("",!0),null!==L.libraryScanFollowSymlinks?((0,n.wg)(),(0,n.j4)(Z,{key:1,modelValue:L.libraryScanFollowSymlinks,"onUpdate:modelValue":l[5]||(l[5]=e=>L.libraryScanFollowSymlinks=e),label:e.$t("components.settings.library.followSymlinks")},null,8,["modelValue","label"])):(0,n.kq)("",!0)]),(0,n.Wm)(O,{class:"q-my-lg"}),(0,n.Wm)("h5",h,(0,a.zw)(e.$t("components.settings.library.fileMonitor")),1),(0,n.Wm)("div",S,[null===L.enableLibraryFileMonitor?((0,n.wg)(),(0,n.j4)(P,{key:0,type:"QToggle"})):((0,n.wg)(),(0,n.j4)(Z,{key:1,modelValue:L.enableLibraryFileMonitor,"onUpdate:modelValue":l[6]||(l[6]=e=>L.enableLibraryFileMonitor=e),label:e.$t("components.settings.library.enableLibraryFileMonitor")},null,8,["modelValue","label"]))]),(0,n.Wm)(O,{class:"q-my-lg"}),(0,n.Wm)("h5",k,(0,a.zw)(e.$t("components.settings.library.fileTesting")),1),(0,n.Wm)("div",w,[null===L.concurrentFileTesters?((0,n.wg)(),(0,n.j4)(P,{key:0,type:"QInput"})):(0,n.kq)("",!0),null!==L.concurrentFileTesters?((0,n.wg)(),(0,n.j4)(Q,{key:1,readonly:"",outlined:"",color:"primary",modelValue:L.concurrentFileTesters,"onUpdate:modelValue":l[7]||(l[7]=e=>L.concurrentFileTesters=e),label:e.$t("components.settings.library.concurrentFileTesters"),placeholder:L.concurrentFileTesters},null,8,["modelValue","label","placeholder"])):(0,n.kq)("",!0),null===L.concurrentFileTesters?((0,n.wg)(),(0,n.j4)(P,{key:2,type:"QSlider"})):(0,n.kq)("",!0),null!==L.concurrentFileTesters?((0,n.wg)(),(0,n.j4)(U,{key:3,modelValue:L.concurrentFileTesters,"onUpdate:modelValue":l[8]||(l[8]=e=>L.concurrentFileTesters=e),min:1,max:10,step:1,color:"primary"},null,8,["modelValue"])):(0,n.kq)("",!0)]),(0,n.Wm)(O,{class:"q-my-lg"}),(0,n.Wm)("h5",q,(0,a.zw)(e.$t("components.settings.library.pendingTasks")),1),(0,n.Wm)("div",_,[null===L.clearPendingTasksOnStart?((0,n.wg)(),(0,n.j4)(P,{key:0,type:"QToggle"})):((0,n.wg)(),(0,n.j4)(Z,{key:1,modelValue:L.clearPendingTasksOnStart,"onUpdate:modelValue":l[9]||(l[9]=e=>L.clearPendingTasksOnStart=e),label:e.$t("components.settings.library.clearPendingTasksOnStart")},null,8,["modelValue","label"]))]),(0,n.Wm)("div",null,[(0,n.Wm)(C,{label:e.$t("navigation.submit"),type:"submit",color:"secondary"},null,8,["label"])])])),_:1},8,["onSubmit"])])])]),e.$q.platform.is.mobile?((0,n.wg)(),(0,n.j4)("div",f,[(0,n.Wm)(O,{class:"q-mb-lg"}),(0,n.Wm)("div",W,[v,(0,n.Wm)("div",T,[(0,n.Wm)(M,{flat:"",bordered:"",onClick:l[10]||(l[10]=l=>e.$router.push("/ui/settings-workers")),class:"bg-grey-1 q-ma-xs"},{default:(0,n.w5)((()=>[(0,n.Wm)(C,{"icon-right":"navigate_next",flat:""},{default:(0,n.w5)((()=>[F])),_:1})])),_:1})])])])):(0,n.kq)("",!0)])])),_:1})}var L=t(4190),$=t(1959),P=t(8825),j=t(5948),Q=t(1536),O=t(52),Z=t.n(O),U=t(7689);const C={name:"SettingsLibrary",setup(){(0,P.Z)();const{t:e}=(0,j.QT)();let l=null,t=(0,L.A)(e);function a(){l=t.init()}function r(){t.close()}(0,n.bv)((()=>{a()})),(0,n.Ah)((()=>{r()}))},data(){return{libraryPath:(0,$.iH)(null),enableLibraryScanner:(0,$.iH)(null),libraryScanSchedule:(0,$.iH)(null),libraryScanFollowSymlinks:(0,$.iH)(null),concurrentFileTesters:(0,$.iH)(null),runLibraryScanOnStart:(0,$.iH)(null),enableLibraryFileMonitor:(0,$.iH)(null),clearPendingTasksOnStart:(0,$.iH)(null)}},methods:{updateLibraryWithDirectoryBrowser:function(){this.$q.dialog({component:Q.Z,componentProps:{dialogHeader:this.$t("headers.selectDirectory"),initialPath:this.libraryPath,listType:"directories"}}).onOk((e=>{"undefined"!==typeof e.selectedPath&&null!==e.selectedPath&&(this.libraryPath=e.selectedPath)})).onDismiss((()=>{}))},fetchSettings:function(){Z()({method:"get",url:(0,U.J4)("v2","settings/read")}).then((e=>{this.libraryPath=e.data.settings.library_path,this.enableLibraryScanner=e.data.settings.enable_library_scanner,this.libraryScanSchedule=e.data.settings.schedule_full_scan_minutes,this.libraryScanFollowSymlinks=e.data.settings.follow_symlinks,this.concurrentFileTesters=e.data.settings.concurrent_file_testers,this.runLibraryScanOnStart=e.data.settings.run_full_scan_on_start,this.enableLibraryFileMonitor=e.data.settings.enable_inotify,this.clearPendingTasksOnStart=e.data.settings.clear_pending_tasks_on_restart})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.failedToFetchSettings"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},save:function(){let e={settings:{library_path:this.libraryPath,enable_library_scanner:this.enableLibraryScanner,schedule_full_scan_minutes:this.libraryScanSchedule,follow_symlinks:this.libraryScanFollowSymlinks,concurrent_file_testers:this.concurrentFileTesters,run_full_scan_on_start:this.runLibraryScanOnStart,enable_inotify:this.enableLibraryFileMonitor,clear_pending_tasks_on_restart:this.clearPendingTasksOnStart}};Z()({method:"post",url:(0,U.J4)("v2","settings/write"),data:e}).then((e=>{this.fetchSettings(),this.$q.notify({color:"positive",position:"top",icon:"cloud_done",message:this.$t("notifications.saved"),timeout:200})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.failedToSaveSettings"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}},created(){this.fetchSettings()}};var H=t(4379),M=t(5269),x=t(4103),z=t(4842),D=t(4554),I=t(5869),B=t(8886),A=t(2064),J=t(2165),N=t(151),E=t(7518),G=t.n(E);C.render=V;const K=C;G()(C,"components",{QPage:H.Z,QForm:M.Z,QSkeleton:x.ZP,QInput:z.Z,QIcon:D.Z,QSeparator:I.Z,QToggle:B.Z,QSlider:A.Z,QBtn:J.Z,QCard:N.Z})}}]);