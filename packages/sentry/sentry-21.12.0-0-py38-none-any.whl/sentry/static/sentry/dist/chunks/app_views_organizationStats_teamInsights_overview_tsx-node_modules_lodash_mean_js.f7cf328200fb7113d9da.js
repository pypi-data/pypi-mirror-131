(self.webpackChunk=self.webpackChunk||[]).push([["app_views_organizationStats_teamInsights_overview_tsx-node_modules_lodash_mean_js","node_modules_lodash_mean_js"],{"./app/components/pageTimeRangeSelector.tsx":(e,t,r)=>{"use strict";r.d(t,{Z:()=>g});var n=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=(r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/react/index.js")),o=r("./app/components/organizations/timeRangeSelector/index.tsx"),i=r("./app/components/panels/index.tsx"),a=r("./app/constants/index.tsx"),d=r("./app/locale.tsx"),l=r("./app/styles/space.tsx"),c=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function u({className:e,...t}){const[r,n]=(0,s.useState)(!1);return(0,c.tZ)(p,{className:e,isCalendarOpen:r,children:(0,c.tZ)(o.Z,{label:(0,c.tZ)(m,{children:(0,d.t)("Date Range:")}),onToggleSelector:e=>n(e),relativeOptions:a.wh,...t},"period:".concat(t.relative,"-start:").concat(t.start,"-end:").concat(t.end,"-utc:").concat(t.utc,"-defaultPeriod:").concat(t.defaultPeriod))})}u.displayName="PageTimeRangeSelector";const p=(0,n.Z)(i.s_,{target:"e1hsuxgy1"})("display:flex;justify-content:center;align-items:center;height:42px;background:",(e=>e.theme.background),";border:1px solid ",(e=>e.theme.border),";border-radius:",(e=>e.isCalendarOpen?"".concat(e.theme.borderRadius," ").concat(e.theme.borderRadius," 0 0"):e.theme.borderRadius),";padding:0;margin:0;font-size:",(e=>e.theme.fontSizeMedium),";color:",(e=>e.theme.textColor),";>div{width:100%;align-self:stretch;}>div>div:first-child{padding:0 ",(0,l.Z)(2),";}>div>div:last-child{box-sizing:content-box;font-size:1em;}"),m=(0,n.Z)("span",{target:"e1hsuxgy0"})("text-align:left;font-weight:600;color:",(e=>e.theme.textColor),";>span:last-child{font-weight:400;}"),g=u},"./app/utils/discover/discoverQuery.tsx":(e,t,r)=>{"use strict";r.d(t,{Z:()=>d}),r("../node_modules/react/index.js");var n=r("./app/utils/withApi.tsx"),s=r("./app/utils/discover/genericDiscoverQuery.tsx"),o=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e,t){return e.transactionName!==t.transactionName||e.transactionThreshold!==t.transactionThreshold||e.transactionThresholdMetric!==t.transactionThresholdMetric}function a(e){return(0,o.tZ)(s.ZP,{route:"eventsv2",shouldRefetchData:i,...e})}a.displayName="DiscoverQuery";const d=(0,n.Z)(a)},"./app/views/organizationStats/header.tsx":(e,t,r)=>{"use strict";r.d(t,{Z:()=>p});var n=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=r("./app/components/button.tsx"),o=r("./app/components/featureBadge.tsx"),i=r("./app/components/layouts/thirds.tsx"),a=r("./app/components/links/link.tsx"),d=r("./app/locale.tsx"),l=r("./app/styles/space.tsx"),c=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function u({organization:e,activeTab:t}){return(0,c.BX)(i.h4,{children:[(0,c.tZ)(i.oB,{children:(0,c.tZ)(m,{children:(0,d.t)("Stats")})}),(0,c.tZ)(i.kP,{children:"team"===t&&(0,c.tZ)(s.ZP,{title:(0,d.t)("Send us feedback via email"),size:"small",href:"mailto:workflow-feedback@sentry.io?subject=Team Stats Feedback",children:(0,d.t)("Give Feedback")})}),(0,c.BX)(i.mL,{underlined:!0,children:[(0,c.tZ)("li",{className:"".concat("stats"===t?"active":""),children:(0,c.tZ)(a.Z,{to:"/organizations/".concat(e.slug,"/stats/"),children:(0,d.t)("Usage Stats")})}),(0,c.tZ)("li",{className:"".concat("team"===t?"active":""),children:(0,c.BX)(a.Z,{to:"/organizations/".concat(e.slug,"/stats/team/"),children:[(0,d.t)("Team Stats"),(0,c.tZ)(o.Z,{type:"beta"})]})})]})]})}u.displayName="StatsHeader";const p=u,m=(0,n.Z)(i.Dx,{target:"e8yr0f60"})("margin-top:",(0,l.Z)(.5),";")},"./app/views/organizationStats/teamInsights/overview.tsx":(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>lt});var n=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=r("../node_modules/react/index.js"),o=r("../node_modules/@emotion/react/dist/emotion-element-a8309070.browser.esm.js"),i=r("../node_modules/lodash/pick.js"),a=r.n(i),d=r("../node_modules/moment/moment.js"),l=r.n(d),c=r("./app/components/forms/teamSelector.tsx"),u=r("./app/components/layouts/thirds.tsx"),p=r("./app/components/loadingIndicator.tsx"),m=r("./app/components/noProjectMessage.tsx"),g=r("./app/components/organizations/globalSelectionHeader/getParams.tsx"),h=r("./app/components/pageTimeRangeSelector.tsx"),Z=r("./app/locale.tsx"),v=r("./app/styles/space.tsx"),f=r("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),x=r("./app/utils/isActiveSuperuser.tsx"),y=r("./app/utils/localStorage.tsx"),b=r("./app/utils/useOrganization.tsx"),w=r("./app/utils/useTeams.tsx"),S=r("./app/views/organizationStats/header.tsx"),j=(r("../node_modules/core-js/modules/es.symbol.description.js"),r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js"));function z({title:e,description:t,children:r}){return(0,j.BX)(T,{children:[(0,j.BX)(_,{children:[(0,j.tZ)(D,{children:e}),(0,j.tZ)(B,{children:t})]}),(0,j.tZ)(M,{children:r})]})}z.displayName="DescriptionCard";const k=z,T=(0,n.Z)("div",{target:"eyf29hd4"})("border:1px solid ",(e=>e.theme.border),";border-radius:",(e=>e.theme.borderRadius),";display:flex;margin-bottom:",(0,v.Z)(3),";flex-direction:column;@media (min-width: ",(e=>e.theme.breakpoints[1]),"){flex-direction:row;}"),_=(0,n.Z)("div",{target:"eyf29hd3"})("padding:",(0,v.Z)(2)," ",(0,v.Z)(2),";border-bottom:1px solid ",(e=>e.theme.border),";@media (min-width: ",(e=>e.theme.breakpoints[1]),"){max-width:250px;border-right:1px solid ",(e=>e.theme.border),";border-bottom:0;}"),D=(0,n.Z)("div",{target:"eyf29hd2"})("font-size:",(e=>e.theme.fontSizeLarge),";margin:0 0 ",(0,v.Z)(.5),";"),B=(0,n.Z)("div",{target:"eyf29hd1"})("color:",(e=>e.theme.subText),";font-size:",(e=>e.theme.fontSizeMedium),";"),M=(0,n.Z)("div",{target:"eyf29hd0"})({name:"1ff36h2",styles:"flex-grow:1"});var R=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),q=(r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("./app/components/asyncComponent.tsx")),N=r("./app/components/charts/barChart.tsx"),L=r("../node_modules/lodash/chunk.js"),C=r.n(L);function P(e){const t=e.sort(((e,t)=>new Date(e.name).getTime()-new Date(t.name).getTime()));return C()(t,7).map((e=>({name:e[0].name,value:e.reduce(((e,t)=>e+t.value),0)})))}function A(e){return Object.entries(e).map((([e,t])=>({value:t,name:new Date(e).getTime()})))}function X(e){return[...e.filter((e=>Math.round(e.trend)<0)),...e.filter((e=>Math.round(e.trend)>0)),...e.filter((e=>0===Math.round(e.trend)))]}const I=e=>({splitNumber:e,type:"category",min:0,axisLabel:{showMaxLabel:!0,showMinLabel:!0,formatter:e=>l()(new Date(Number(e))).format("MMM D")}});class E extends q.Z{constructor(...e){super(...e),(0,R.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),alertsTriggered:null}}getEndpoints(){const{organization:e,start:t,end:r,period:n,utc:s,teamSlug:o}=this.props,i={start:t,end:r,period:n,utc:s};return[["alertsTriggered","/teams/".concat(e.slug,"/").concat(o,"/alerts-triggered/"),{query:{...(0,g.Q)(i)}}]]}componentDidUpdate(e){const{start:t,end:r,period:n,utc:s,teamSlug:o}=this.props;e.start===t&&e.end===r&&e.period===n&&e.utc===s&&e.teamSlug===o||this.remountComponent()}renderLoading(){return(0,j.tZ)(O,{children:(0,j.tZ)(p.Z,{})})}renderBody(){const{alertsTriggered:e}=this.state,t=P(A(null!=e?e:{}));return(0,j.tZ)(O,{children:e&&(0,j.tZ)(N.Z,{style:{height:190},isGroupedByDate:!0,useShortDate:!0,period:"7d",legend:{right:0,top:0},yAxis:{minInterval:1},xAxis:I(t.length),series:[{seriesName:(0,Z.t)("Alerts Triggered"),data:t,silent:!0}]})})}}const F=E,O=(0,n.Z)("div",{target:"e1w90l1w0"})("padding:",(0,v.Z)(2)," ",(0,v.Z)(2)," 0 ",(0,v.Z)(2),";");var Q=r("../node_modules/lodash/isEqual.js"),U=r.n(Q),G=r("./app/components/idBadge/index.tsx"),V=r("./app/components/panels/panelTable.tsx"),H=r("./app/components/placeholder.tsx"),K=r("./app/utils/formatters.tsx");class W extends q.Z{constructor(...e){super(...e),(0,R.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),issuesBreakdown:null}}getEndpoints(){const{organization:e,start:t,end:r,period:n,utc:s,teamSlug:o}=this.props,i={start:t,end:r,period:n,utc:s};return[["issuesBreakdown","/teams/".concat(e.slug,"/").concat(o,"/issue-breakdown/"),{query:{...(0,g.Q)(i)}}]]}componentDidUpdate(e){const{start:t,end:r,period:n,utc:s,teamSlug:o,projects:i}=this.props;e.start===t&&e.end===r&&e.period===n&&e.utc===s&&e.teamSlug===o&&U()(e.projects,i)||this.remountComponent()}renderLoading(){return this.renderBody()}renderBody(){const{issuesBreakdown:e,loading:t}=this.state,{projects:r}=this.props,n={},o={},i={};if(e)for(const[t,r]of Object.entries(e))for(const[e,{reviewed:s,total:a}]of Object.entries(r)){i[t]||(i[t]={reviewed:0,total:0}),i[t].reviewed+=s,i[t].total+=a,void 0===n[e]?n[e]=s:n[e]+=s;const r=a-s;void 0===o[e]?o[e]=r:o[e]+=r}const a=P(A(n)),d=P(A(o));return(0,j.BX)(s.Fragment,{children:[(0,j.BX)($,{children:[t&&(0,j.tZ)(H.Z,{height:"200px"}),!t&&(0,j.tZ)(N.Z,{style:{height:200},stacked:!0,isGroupedByDate:!0,useShortDate:!0,legend:{right:0,top:0},xAxis:I(a.length),yAxis:{minInterval:1},series:[{seriesName:(0,Z.t)("Reviewed"),data:a,silent:!0},{seriesName:(0,Z.t)("Not Reviewed"),data:d,silent:!0}]})]}),(0,j.tZ)(ee,{headers:[(0,Z.t)("Project"),(0,j.tZ)(ne,{children:(0,Z.t)("For Review")},"forReview"),(0,j.tZ)(ne,{children:(0,Z.t)("Reviewed")},"reviewed"),(0,j.tZ)(ne,{children:(0,Z.t)("% Reviewed")},"change")],isLoading:t,children:r.map((e=>{var t;const{total:r,reviewed:n}=null!==(t=i[e.id])&&void 0!==t?t:{};return(0,j.BX)(s.Fragment,{children:[(0,j.tZ)(te,{children:(0,j.tZ)(re,{avatarSize:18,project:e})}),(0,j.tZ)(ne,{children:r}),(0,j.tZ)(ne,{children:n}),(0,j.tZ)(ne,{children:0===r?"â€”":(0,K.rl)(n/r)})]},e.id)}))})]})}}const J=W,Y=(0,n.Z)("div",{target:"e1tnpmhr5"})("padding:",(0,v.Z)(2)," ",(0,v.Z)(2)," 0 ",(0,v.Z)(2),";"),$=(0,n.Z)(Y,{target:"e1tnpmhr4"})("border-bottom:1px solid ",(e=>e.theme.border),";"),ee=(0,n.Z)(V.Z,{target:"e1tnpmhr3"})("grid-template-columns:1fr 0.2fr 0.2fr 0.2fr;font-size:",(e=>e.theme.fontSizeMedium),";white-space:nowrap;margin-bottom:0;border:0;box-shadow:unset;&>div{padding:",(0,v.Z)(1)," ",(0,v.Z)(2),";}"),te=(0,n.Z)("div",{target:"e1tnpmhr2"})({name:"zjik7",styles:"display:flex"}),re=(0,n.Z)(G.Z,{target:"e1tnpmhr1"})({name:"ozd7xs",styles:"flex-shrink:0"}),ne=(0,n.Z)("div",{target:"e1tnpmhr0"})({name:"mnwtso",styles:"text-align:right;font-variant-numeric:tabular-nums"});var se=r("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),oe=r("./app/components/button.tsx"),ie=r("./app/components/links/link.tsx"),ae=r("./app/components/loadingError.tsx"),de=r("./app/icons/index.tsx"),le=r("./app/styles/overflowEllipsis.tsx"),ce=r("./app/utils/discover/discoverQuery.tsx"),ue=r("./app/utils/discover/eventView.tsx"),pe=r("./app/utils/discover/fieldRenderers.tsx"),me=r("./app/views/performance/transactionSummary/utils.tsx");function ge({organization:e,location:t,projects:r,periodTableData:n,weekTableData:o,isLoading:i,period:a,error:d}){var l;const[c,u]=(0,s.useState)(!1),p=(null==n?void 0:n.meta)&&(0,pe.Js)("user_misery",n.meta),m=X((null!==(l=null==n?void 0:n.data)&&void 0!==l?l:[]).map((e=>{const t=null==o?void 0:o.data.find((t=>t.project===e.project&&t.transaction===e.transaction)),r=t?100*(e.user_misery-t.user_misery):null;return{...e,trend:r}})).filter((e=>null!==e.trend)).sort(((e,t)=>Math.abs(t.trend)-Math.abs(e.trend))));return d?(0,j.tZ)(ae.Z,{}):(0,j.BX)(s.Fragment,{children:[(0,j.tZ)(ve,{isEmpty:0===r.length||0===(null==n?void 0:n.data.length),emptyMessage:(0,Z.t)("No Key Transactions Starred By This Team"),emptyAction:(0,j.tZ)(oe.ZP,{size:"small",external:!0,href:"https://docs.sentry.io/product/performance/transaction-summary/#starring-key-transactions",children:(0,Z.t)("Learn More")}),headers:[(0,j.BX)(fe,{children:[(0,j.tZ)(ye,{isSolid:!0,color:"yellow300"})," ",(0,Z.t)("Key transaction")]},"transaction"),(0,Z.t)("Project"),(0,Z._N)("Last [period]",{period:a}),(0,Z.t)("Last 7 Days"),(0,j.tZ)(je,{children:(0,Z.t)("Change")},"change")],isLoading:i,children:m.map(((n,i)=>{const a=r.find((({slug:e})=>n.project===e)),{trend:d,project:l,transaction:u}=n,m=null==o?void 0:o.data.find((e=>e.project===l&&e.transaction===u));if(!m||null===d)return null;const g=null==p?void 0:p(n,{organization:e,location:t}),h=m&&(null==p?void 0:p(m,{organization:e,location:t})),v=Math.round(Math.abs(d));return i>=5&&!c?null:(0,j.BX)(s.Fragment,{children:[(0,j.BX)(xe,{children:[(0,j.tZ)("div",{children:(0,j.tZ)(ye,{isSolid:!0,color:"yellow300"})}),(0,j.tZ)(Se,{children:(0,j.tZ)(ie.Z,{to:(0,me.e1)({orgSlug:e.slug,transaction:n.transaction,projectID:null==a?void 0:a.id,query:{query:"transaction.duration:<15m"}}),children:n.transaction})})]}),(0,j.tZ)(fe,{children:(0,j.tZ)(be,{children:a&&(0,j.tZ)(we,{avatarSize:18,project:a})})}),(0,j.tZ)(fe,{children:g}),(0,j.tZ)(fe,{children:null!=h?h:"â€”"}),(0,j.tZ)(ze,{children:0===v?(0,j.BX)(ke,{children:["0% ",(0,Z.t)("change")]}):(0,j.BX)(Te,{color:d>=0?"green300":"red300",children:["".concat(v,"% "),d>=0?(0,Z.t)("better"):(0,Z.t)("worse")]})})]},i)}))}),m.length>=5&&!c&&!i&&(0,j.BX)(_e,{onClick:function(){u(!0)},children:[(0,j.BX)(Be,{children:[(0,j.tZ)(De,{color:"gray300"}),(0,Z._N)("Show [count] More",{count:m.length-1-5})]}),(0,j.tZ)(de.g6,{color:"gray300",direction:"down"})]})]})}function he({organization:e,teamId:t,projects:r,location:n,period:s,start:o,end:i}){if(0===r.length)return(0,j.tZ)(ge,{isLoading:!1,organization:e,location:n,projects:[],period:s,periodTableData:{data:[]},weekTableData:{data:[]}});const a={id:void 0,query:"transaction.duration:<15m team_key_transaction:true",projects:[],version:2,orderby:"-tpm",teams:[Number(t)],fields:["transaction","project","tpm()","count_unique(user)","count_miserable(user)","user_misery()"]},d=ue.ZP.fromSavedQuery({...a,name:"periodMisery",range:s,start:o,end:i}),l=ue.ZP.fromSavedQuery({...a,name:"weekMisery",range:"7d"});return(0,j.tZ)(ce.Z,{eventView:d,orgSlug:e.slug,location:n,children:({isLoading:t,tableData:o,error:i})=>(0,j.tZ)(ce.Z,{eventView:l,orgSlug:e.slug,location:n,children:({isLoading:a,tableData:d,error:l})=>(0,j.tZ)(ge,{isLoading:t||a,organization:e,location:n,projects:r,period:s,periodTableData:o,weekTableData:d,error:null!=i?i:l})})})}ge.displayName="TeamMisery",he.displayName="TeamMiseryWrapper";const Ze=he,ve=(0,n.Z)(V.Z,{target:"e1uglq213"})("grid-template-columns:1.25fr 0.5fr 112px 112px 0.25fr;font-size:",(e=>e.theme.fontSizeMedium),";white-space:nowrap;margin-bottom:0;border:0;box-shadow:unset;&>div{padding:",(0,v.Z)(1)," ",(0,v.Z)(2),";}",(e=>e.isEmpty&&(0,se.iv)("&>div:last-child{padding:48px ",(0,v.Z)(2),";}","")),";"),fe=(0,n.Z)("div",{target:"e1uglq212"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),xe=(0,n.Z)("div",{target:"e1uglq211"})(le.Z,";display:flex;align-items:center;"),ye=(0,n.Z)(de.GK,{target:"e1uglq210"})("display:block;margin-right:",(0,v.Z)(1),";margin-bottom:",(0,v.Z)(.5),";"),be=(0,n.Z)("div",{target:"e1uglq29"})({name:"zjik7",styles:"display:flex"}),we=(0,n.Z)(G.Z,{target:"e1uglq28"})({name:"ozd7xs",styles:"flex-shrink:0"}),Se=(0,n.Z)("div",{target:"e1uglq27"})(le.Z,";"),je=(0,n.Z)("span",{target:"e1uglq26"})({name:"2qga7i",styles:"text-align:right"}),ze=(0,n.Z)("div",{target:"e1uglq25"})({name:"4os8x4",styles:"display:flex;align-items:center;justify-content:flex-end;text-align:right"}),ke=(0,n.Z)("div",{target:"e1uglq24"})("color:",(e=>e.theme.subText),";"),Te=(0,n.Z)("div",{target:"e1uglq23"})("color:",(e=>e.theme[e.color]),";"),_e=(0,n.Z)("div",{target:"e1uglq22"})("display:flex;align-items:center;padding:",(0,v.Z)(1)," ",(0,v.Z)(2),";font-size:",(e=>e.theme.fontSizeMedium),";color:",(e=>e.theme.subText),";cursor:pointer;border-top:1px solid ",(e=>e.theme.border),";"),De=(0,n.Z)(de.Zd,{target:"e1uglq21"})("margin-right:",(0,v.Z)(1),";"),Be=(0,n.Z)("div",{target:"e1uglq20"})({name:"18keaja",styles:"display:flex;align-items:center;flex-grow:1"});var Me=r("../node_modules/lodash/round.js"),Re=r.n(Me),qe=r("./app/components/charts/components/markLine.tsx"),Ne=r("./app/components/charts/utils.tsx");class Le extends q.Z{constructor(...e){super(...e),(0,R.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),weekReleases:null,periodReleases:null}}getEndpoints(){const{organization:e,start:t,end:r,period:n,utc:s,teamSlug:o}=this.props,i={start:t,end:r,period:n,utc:s};return[["periodReleases","/teams/".concat(e.slug,"/").concat(o,"/release-count/"),{query:{...(0,g.Q)(i)}}],["weekReleases","/teams/".concat(e.slug,"/").concat(o,"/release-count/"),{query:{statsPeriod:"7d"}}]]}componentDidUpdate(e){const{teamSlug:t,start:r,end:n,period:s,utc:o}=this.props;e.start===r&&e.end===n&&e.period===s&&e.utc===o&&U()(e.teamSlug,t)||this.remountComponent()}getReleaseCount(e,t){const{periodReleases:r,weekReleases:n}=this.state,s="week"===t?null==n?void 0:n.last_week_totals:null==r?void 0:r.project_avgs;return null!=s&&s[e]?Math.ceil(null==s?void 0:s[e]):0}getTrend(e){const t=this.getReleaseCount(e,"period"),r=this.getReleaseCount(e,"week");return null===t||null===r?null:r-t}renderLoading(){return this.renderBody()}renderReleaseCount(e,t){const{loading:r}=this.state;if(r)return(0,j.tZ)("div",{children:(0,j.tZ)(H.Z,{width:"80px",height:"25px"})});const n=this.getReleaseCount(Number(e),t);return null===n?"â€”":n}renderTrend(e){const{loading:t}=this.state;if(t)return(0,j.tZ)("div",{children:(0,j.tZ)(H.Z,{width:"80px",height:"25px"})});const r=this.getTrend(Number(e));return null===r?"â€”":(0,j.BX)(Fe,{color:r>=0?"green300":"red300",children:["".concat(Re()(Math.abs(r),3)),(0,j.tZ)(Ee,{direction:r>=0?"up":"down",size:"xs"})]})}renderBody(){var e,t;const{projects:r,period:n,theme:o,organization:i}=this.props,{periodReleases:a}=this.state,d=X(r.map((e=>{var t;return{project:e,trend:null!==(t=this.getTrend(Number(e.id)))&&void 0!==t?t:0}})).sort(((e,t)=>Math.abs(t.trend)-Math.abs(e.trend)))),c=P(Object.entries(null!==(e=null==a?void 0:a.release_counts)&&void 0!==e?e:{}).map((([e,t])=>({value:Math.ceil(t),name:new Date(e).getTime()})))),u=Object.values(null!==(t=null==a?void 0:a.project_avgs)&&void 0!==t?t:{}),p=u.reduce(((e,t)=>e+t),0),m=Math.ceil(p/u.length);return(0,j.BX)("div",{children:[(0,j.tZ)(Pe,{children:(0,j.tZ)(N.Z,{style:{height:190},isGroupedByDate:!0,useShortDate:!0,period:"7d",legend:{right:3,top:0},yAxis:{minInterval:1},xAxis:I(c.length),series:[{seriesName:(0,Z.t)("This Period"),silent:!0,data:c,markLine:(0,qe.Z)({silent:!0,lineStyle:{color:o.gray200,type:"dashed",width:1},data:[{yAxis:m}],label:{show:!1}})}],tooltip:{formatter:e=>{const[t]=Array.isArray(e)?e:[e],r="MMM D",s=l()(t.data[0]).format(r),o=l()(t.data[0]).add(7,"days").format(r);return['<div class="tooltip-series">','<div><span class="tooltip-label">'.concat(t.marker," <strong>").concat(t.seriesName,"</strong></span> ").concat(t.data[1],"</div>"),'<div><span class="tooltip-label"><strong>Last '.concat(n," Average</strong></span> ").concat(m,"</div>"),"</div>",'<div class="tooltip-date">'.concat(s," - ").concat(o,"</div>"),(0,Ne.U8)()].join("")}}})}),(0,j.tZ)(Ae,{isEmpty:0===r.length,headers:[(0,Z.t)("Project"),(0,j.tZ)(Xe,{children:(0,Z._N)("Last [period] Average",{period:n})},"last"),(0,j.tZ)(Xe,{children:(0,Z.t)("Last 7 Days")},"curr"),(0,j.tZ)(Xe,{children:(0,Z.t)("Difference")},"diff")],children:d.map((({project:e})=>(0,j.BX)(s.Fragment,{children:[(0,j.tZ)(Oe,{children:(0,j.tZ)(Qe,{avatarSize:18,project:e})}),(0,j.tZ)(Ie,{children:this.renderReleaseCount(e.id,"period")}),(0,j.tZ)(Ie,{children:(0,j.tZ)(ie.Z,{to:{pathname:"/organizations/".concat(i.slug,"/releases/"),query:{project:e.id,statsPeriod:"7d"}},children:this.renderReleaseCount(e.id,"week")})}),(0,j.tZ)(Ie,{children:this.renderTrend(e.id)})]},e.id)))})]})}}const Ce=(0,o.b)(Le),Pe=(0,n.Z)("div",{target:"e1az29pq7"})("padding:",(0,v.Z)(2)," ",(0,v.Z)(2)," 0 ",(0,v.Z)(2),";border-bottom:1px solid ",(e=>e.theme.border),";"),Ae=(0,n.Z)(V.Z,{target:"e1az29pq6"})("grid-template-columns:1fr 0.2fr 0.2fr 0.2fr;white-space:nowrap;margin-bottom:0;border:0;font-size:",(e=>e.theme.fontSizeMedium),";box-shadow:unset;&>div{padding:",(0,v.Z)(1)," ",(0,v.Z)(2),";}"),Xe=(0,n.Z)("span",{target:"e1az29pq5"})({name:"2qga7i",styles:"text-align:right"}),Ie=(0,n.Z)("div",{target:"e1az29pq4"})({name:"4os8x4",styles:"display:flex;align-items:center;justify-content:flex-end;text-align:right"}),Ee=(0,n.Z)(de.CC,{target:"e1az29pq3"})("margin:0 ",(0,v.Z)(.5),";"),Fe=(0,n.Z)("div",{target:"e1az29pq2"})("color:",(e=>e.theme[e.color]),";"),Oe=(0,n.Z)("div",{target:"e1az29pq1"})({name:"zjik7",styles:"display:flex"}),Qe=(0,n.Z)(G.Z,{target:"e1az29pq0"})({name:"ozd7xs",styles:"flex-shrink:0"});class Ue extends q.Z{constructor(...e){super(...e),(0,R.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),resolutionTime:null}}getEndpoints(){const{organization:e,start:t,end:r,period:n,utc:s,teamSlug:o}=this.props,i={start:t,end:r,period:n,utc:s};return[["resolutionTime","/teams/".concat(e.slug,"/").concat(o,"/time-to-resolution/"),{query:{...(0,g.Q)(i)}}]]}renderLoading(){return(0,j.tZ)(Ve,{children:(0,j.tZ)(p.Z,{})})}renderBody(){const{resolutionTime:e}=this.state,t=P(Object.entries(null!=e?e:{}).map((([e,{avg:t}])=>({value:t,name:new Date(e).getTime()}))));return(0,j.tZ)(Ve,{children:(0,j.tZ)(N.Z,{style:{height:190},isGroupedByDate:!0,useShortDate:!0,period:"7d",tooltip:{valueFormatter:e=>(0,K.g9)(e,1)},yAxis:{minInterval:86400,axisLabel:{formatter:e=>0===e?"":(0,K.g9)(e,0,!0,!0)}},legend:{right:0,top:0},xAxis:I(t.length),series:[{seriesName:(0,Z.t)("Time to Resolution"),data:t,silent:!0}]})})}}const Ge=Ue,Ve=(0,n.Z)("div",{target:"e1s8s0fe0"})("padding:",(0,v.Z)(2)," ",(0,v.Z)(2)," 0 ",(0,v.Z)(2),";");var He=r("./app/types/index.tsx"),Ke=r("./app/utils/sessions.tsx"),We=r("./app/views/releases/utils/index.tsx");class Je extends q.Z{constructor(...e){super(...e),(0,R.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),weekSessions:null,periodSessions:null}}getEndpoints(){const{organization:e,start:t,end:r,period:n,utc:s,projects:o}=this.props,i=o.filter((e=>e.hasSessions));if(0===i.length)return[];const a={start:t,end:r,period:n,utc:s},d={environment:[],project:i.map((e=>e.id)),field:"sum(session)",groupBy:["session.status","project"],interval:"1d"};return[["periodSessions","/organizations/".concat(e.slug,"/sessions/"),{query:{...d,...(0,g.Q)(a)}}],["weekSessions","/organizations/".concat(e.slug,"/sessions/"),{query:{...d,statsPeriod:"7d"}}]]}componentDidUpdate(e){const{projects:t,start:r,end:n,period:s,utc:o}=this.props;e.start===r&&e.end===n&&e.period===s&&e.utc===o&&U()(e.projects,t)||this.remountComponent()}getScore(e,t){const{periodSessions:r,weekSessions:n}=this.state,s="week"===t?n:r,o=null==s?void 0:s.groups.filter((t=>t.by.project===e));return(0,Ke.Pn)(o,He.r2.SESSIONS)}getTrend(e){const t=this.getScore(e,"period"),r=this.getScore(e,"week");return null===t||null===r?null:r-t}renderLoading(){return this.renderBody()}renderScore(e,t){const{loading:r}=this.state;if(r)return(0,j.tZ)("div",{children:(0,j.tZ)(H.Z,{width:"80px",height:"25px"})});const n=this.getScore(Number(e),t);return null===n?"â€”":(0,We.zB)(n)}renderTrend(e){const{loading:t}=this.state;if(t)return(0,j.tZ)("div",{children:(0,j.tZ)(H.Z,{width:"80px",height:"25px"})});const r=this.getTrend(Number(e));return null===r?"â€”":(0,j.BX)(nt,{color:r>=0?"green300":"red300",children:["".concat(Re()(Math.abs(r),3),"%"),(0,j.tZ)(rt,{direction:r>=0?"up":"down",size:"xs"})]})}renderBody(){const{projects:e,period:t}=this.props,r=X(e.map((e=>{var t;return{project:e,trend:null!==(t=this.getTrend(Number(e.id)))&&void 0!==t?t:0}})).sort(((e,t)=>Math.abs(t.trend)-Math.abs(e.trend))));return(0,j.tZ)($e,{isEmpty:0===e.length,headers:[(0,Z.t)("Project"),(0,j.tZ)(et,{children:(0,Z._N)("Last [period]",{period:t})},"last"),(0,j.tZ)(et,{children:(0,Z.t)("Last 7 Days")},"curr"),(0,j.tZ)(et,{children:(0,Z.t)("Difference")},"diff")],children:r.map((({project:e})=>(0,j.BX)(s.Fragment,{children:[(0,j.tZ)(st,{children:(0,j.tZ)(ot,{avatarSize:18,project:e})}),(0,j.tZ)(tt,{children:this.renderScore(e.id,"period")}),(0,j.tZ)(tt,{children:this.renderScore(e.id,"week")}),(0,j.tZ)(tt,{children:this.renderTrend(e.id)})]},e.id)))})}}const Ye=Je,$e=(0,n.Z)(V.Z,{target:"e182a5846"})("grid-template-columns:1fr 0.2fr 0.2fr 0.2fr;font-size:",(e=>e.theme.fontSizeMedium),";white-space:nowrap;margin-bottom:0;border:0;box-shadow:unset;&>div{padding:",(0,v.Z)(1)," ",(0,v.Z)(2),";}"),et=(0,n.Z)("span",{target:"e182a5845"})({name:"2qga7i",styles:"text-align:right"}),tt=(0,n.Z)("div",{target:"e182a5844"})({name:"4os8x4",styles:"display:flex;align-items:center;justify-content:flex-end;text-align:right"}),rt=(0,n.Z)(de.CC,{target:"e182a5843"})("margin:0 ",(0,v.Z)(.5),";"),nt=(0,n.Z)("div",{target:"e182a5842"})("color:",(e=>e.theme[e.color]),";"),st=(0,n.Z)("div",{target:"e182a5841"})({name:"zjik7",styles:"display:flex"}),ot=(0,n.Z)(G.Z,{target:"e182a5840"})({name:"ozd7xs",styles:"flex-shrink:0"}),it="8w",at=["pageStatsPeriod","pageStart","pageEnd","pageUtc","dataCategory","transform","sort","query","cursor","team"];function dt({location:e,router:t}){var r,n,i,d,c;const h=(0,x.M)(),z=(0,b.Z)(),{teams:T,initiallyLoaded:_}=(0,w.Z)({provideUserTeams:!0}),D=(0,o.u)(),B=null!==(r=null==e?void 0:e.query)&&void 0!==r?r:{},M="teamInsightsSelectedTeamId:".concat(z.slug);let R=null!==(n=B.team)&&void 0!==n?n:y.Z.getItem(M);R&&!T.find((e=>e.id===R))&&(R=null);const q=null!==(i=R)&&void 0!==i?i:null===(d=T[0])||void 0===d?void 0:d.id,N=T.find((e=>e.id===q)),L=null!==(c=null==N?void 0:N.projects)&&void 0!==c?c:[];function C(r){const n=a()(r,at),s={...e,query:{...B,...n}};return t.push(s),s}(0,s.useEffect)((()=>{(0,f.Z)("team_insights.viewed",{organization:z})}),[]);const{period:P,start:A,end:X,utc:I}=function(){const{start:e,end:t,statsPeriod:r,utc:n}=(0,g.Q)(B,{allowEmptyPeriod:!0,allowAbsoluteDatetime:!0,allowAbsolutePageDatetime:!0});if(!r&&!e&&!t)return{period:it};if(r)return{period:r};const s="true"===n;return e&&t?s?{start:l().utc(e).format(),end:l().utc(t).format(),utc:s}:{start:l()(e).utc().format(),end:l()(t).utc().format(),utc:s}:{period:it}}();return 0===T.length?(0,j.tZ)(m.Z,{organization:z,superuserNeedsToBeProjectMember:!0}):(0,j.BX)(s.Fragment,{children:[(0,j.tZ)(S.Z,{organization:z,activeTab:"team"}),(0,j.BX)(ct,{children:[!_&&(0,j.tZ)(p.Z,{}),_&&(0,j.BX)(u.or,{fullWidth:!0,children:[(0,j.BX)(ut,{children:[(0,j.tZ)(pt,{name:"select-team",inFieldLabel:(0,Z.t)("Team: "),value:null==N?void 0:N.slug,onChange:e=>{return t=e.actor.id,y.Z.setItem(M,t),void C({team:t});var t},teamFilter:h?void 0:e=>e.isMember,styles:{singleValue(e){const t={display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:D.fontSizeMedium,":before":{...e[":before"],color:D.textColor,marginRight:(0,v.Z)(1.5),marginLeft:(0,v.Z)(.5)}};return{...e,...t}},input:(e,t)=>({...e,display:"grid",gridTemplateColumns:"max-content 1fr",alignItems:"center",gridGap:(0,v.Z)(1),":before":{backgroundColor:t.theme.backgroundSecondary,height:24,width:38,borderRadius:3,content:'""',display:"block"}})}}),(0,j.tZ)(mt,{organization:z,relative:null!=P?P:"",start:null!=A?A:null,end:null!=X?X:null,utc:null!=I?I:null,onUpdate:function(e){const{start:t,end:r,relative:n,utc:s}=e;if(t&&r){const e=s?l().utc:l();return C({pageStatsPeriod:void 0,pageStart:e(t).format(),pageEnd:e(r).format(),pageUtc:null!=s?s:void 0})}return C({pageStatsPeriod:n||void 0,pageStart:void 0,pageEnd:void 0,pageUtc:void 0})},showAbsolute:!1,relativeOptions:{"14d":(0,Z.t)("Last 2 weeks"),"4w":(0,Z.t)("Last 4 weeks"),[it]:(0,Z.t)("Last 8 weeks"),"12w":(0,Z.t)("Last 12 weeks")}})]}),(0,j.tZ)(gt,{children:(0,Z.t)("Project Health")}),(0,j.tZ)(k,{title:(0,Z.t)("Crash Free Sessions"),description:(0,Z.t)("The percentage of healthy, errored, and abnormal sessions that didnâ€™t cause a crash."),children:(0,j.tZ)(Ye,{projects:L,organization:z,period:P,start:A,end:X,utc:I})}),(0,j.tZ)(k,{title:(0,Z.t)("User Misery"),description:(0,Z.t)("The number of unique users that experienced load times 4x the projectâ€™s configured threshold."),children:(0,j.tZ)(Ze,{organization:z,projects:L,teamId:N.id,period:P,start:null==A?void 0:A.toString(),end:null==X?void 0:X.toString(),location:e})}),(0,j.tZ)(k,{title:(0,Z.t)("Metric Alerts Triggered"),description:(0,Z.t)("Alerts triggered from the Alert Rules your team created."),children:(0,j.tZ)(F,{organization:z,teamSlug:N.slug,period:P,start:null==A?void 0:A.toString(),end:null==X?void 0:X.toString(),location:e})}),(0,j.tZ)(gt,{children:(0,Z.t)("Team Activity")}),(0,j.tZ)(k,{title:(0,Z.t)("Issues Reviewed"),description:(0,Z.t)("Issues triaged by your team taking an action on them such as resolving, ignoring, marking as reviewed, or deleting."),children:(0,j.tZ)(J,{organization:z,projects:L,teamSlug:N.slug,period:P,start:null==A?void 0:A.toString(),end:null==X?void 0:X.toString(),location:e})}),(0,j.tZ)(k,{title:(0,Z.t)("Time to Resolution"),description:(0,Z.t)("The mean time it took for issues to be resolved by your team."),children:(0,j.tZ)(Ge,{organization:z,teamSlug:N.slug,period:P,start:null==A?void 0:A.toString(),end:null==X?void 0:X.toString(),location:e})}),(0,j.tZ)(k,{title:(0,Z.t)("Number of Releases"),description:(0,Z.t)("A breakdown showing how your team shipped releases over time."),children:(0,j.tZ)(Ce,{projects:L,organization:z,teamSlug:N.slug,period:P,start:A,end:X,utc:I})})]})]})]})}dt.displayName="TeamInsightsOverview";const lt=dt,ct=(0,n.Z)(u.uT,{target:"ese1g3n4"})("margin-bottom:-20px;@media (min-width: ",(e=>e.theme.breakpoints[1]),"){display:block;}"),ut=(0,n.Z)("div",{target:"ese1g3n3"})("display:grid;align-items:center;gap:",(0,v.Z)(1),";margin-bottom:",(0,v.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints[0]),"){grid-template-columns:246px 1fr;}"),pt=(0,n.Z)(c.Z,{target:"ese1g3n2"})("&>div{box-shadow:",(e=>e.theme.dropShadowLight),";}"),mt=(0,n.Z)(h.Z,{target:"ese1g3n1"})({name:"j6w5js",styles:"height:40px;div{min-height:unset;}"}),gt=(0,n.Z)(u.Dx,{target:"ese1g3n0"})("margin-bottom:",(0,v.Z)(1),"!important;")},"../node_modules/lodash/_baseMean.js":(e,t,r)=>{var n=r("../node_modules/lodash/_baseSum.js");e.exports=function(e,t){var r=null==e?0:e.length;return r?n(e,t)/r:NaN}},"../node_modules/lodash/_baseSum.js":e=>{e.exports=function(e,t){for(var r,n=-1,s=e.length;++n<s;){var o=t(e[n]);void 0!==o&&(r=void 0===r?o:r+o)}return r}},"../node_modules/lodash/mean.js":(e,t,r)=>{var n=r("../node_modules/lodash/_baseMean.js"),s=r("../node_modules/lodash/identity.js");e.exports=function(e){return n(e,s)}}}]);
//# sourceMappingURL=../sourcemaps/app_views_organizationStats_teamInsights_overview_tsx-node_modules_lodash_mean_js.f613942ac39dd7ed78c9b5cda161b7bf.js.map