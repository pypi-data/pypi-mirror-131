"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_performance_landing_vitalsCards_tsx"],{"./app/utils/performance/vitals/vitalsCardsDiscoverQuery.tsx":(t,e,i)=>{i.d(e,{Z:()=>p}),i("../node_modules/core-js/modules/web.dom-collections.iterator.js"),i("../node_modules/react/index.js");var n=i("../node_modules/lodash/pick.js"),a=i.n(n),o=i("./app/utils/discover/genericDiscoverQuery.tsx"),r=i("./app/utils/performance/constants.tsx"),s=i("./app/utils/withApi.tsx"),l=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function d(t){const{eventView:e,vitals:i}=t,n=null==e?void 0:e.getEventsAPIPayload(t.location);return{vital:i,...a()(n,["query",...Object.values(r.s)])}}function c(t){return(0,l.tZ)(o.ZP,{getRequestPayload:d,route:"events-vitals",...t,children:({tableData:e,...i})=>t.children({vitalsData:e,...i})})}c.displayName="VitalsCardsDiscoverQuery";const p=(0,s.Z)(c)},"./app/views/performance/landing/vitalsCards.tsx":(t,e,i)=>{i.d(e,{M9:()=>W,q7:()=>T,aU:()=>J,JO:()=>tt});var n=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=(i("../node_modules/core-js/modules/es.symbol.description.js"),i("../node_modules/react/index.js")),o=i("../node_modules/@sentry/minimal/esm/index.js"),r=i("./app/components/card.tsx"),s=i("./app/components/charts/eventsRequest.tsx"),l=i("./app/components/charts/styles.tsx"),d=i("./app/components/charts/utils.tsx"),c=i("./app/components/emptyStateWarning.tsx"),p=i("./app/components/links/link.tsx"),u=i("./app/components/placeholder.tsx"),m=i("./app/components/questionTooltip.tsx"),h=i("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),v=i("../node_modules/react-sparklines/build/index.js"),g=i("../node_modules/prop-types/index.js"),f=i.n(g);class Z extends v.Sparklines{}(0,h.Z)(Z,"propTypes",{children:f().node,data:f().array,limit:f().number,width:f().number,height:f().number,svgWidth:f().number,svgHeight:f().number,preserveAspectRatio:f().string,margin:f().number,style:f().object,min:f().number,max:f().number,onMouseMove:f().func});var x=i("./app/components/tooltip.tsx"),y=i("./app/locale.tsx"),w=i("./app/styles/overflowEllipsis.tsx"),b=i("./app/styles/space.tsx"),k=i("./app/utils.tsx"),S=i("./app/utils/dates.tsx"),_=i("./app/utils/discover/discoverQuery.tsx"),j=i("./app/utils/discover/fields.tsx"),P=i("./app/utils/performance/vitals/constants.tsx"),N=i("./app/utils/performance/vitals/vitalsCardsDiscoverQuery.tsx"),C=i("./app/utils/queryString.tsx"),A=i("./app/utils/theme.tsx"),D=i("./app/utils/useApi.tsx"),H=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const O=t=>(0,H.tZ)(z,{barHeight:t.barHeight,fractions:t.colorStops.map((({percent:t})=>t)),children:t.colorStops.map((t=>(0,H.tZ)(q,{color:t.color},t.color)))});O.displayName="ColorBar";const z=(0,n.Z)("div",{target:"etd41501"})("height:",(t=>t.barHeight?"".concat(t.barHeight,"px"):"16px"),";width:100%;overflow:hidden;position:relative;background:",(t=>t.theme.gray100),";display:grid;grid-template-columns:",(t=>t.fractions.map((t=>"".concat(t,"fr"))).join(" ")),";margin-bottom:",(t=>t.barHeight?"":(0,b.Z)(1)),";border-radius:2px;"),q=(0,n.Z)("div",{target:"etd41500"})("background-color:",(t=>t.theme[t.color]),";"),B=O;var M=i("./app/views/performance/vitalDetail/utils.tsx"),V=i("./app/utils/formatters.tsx");function L(t,e){const i=Array.isArray(t)||t===j.Zl.CLS?"":"ms";switch(e){case M.SP.POOR:return Array.isArray(t)?(0,y.t)("Poor"):(0,y._N)("Poor: >[threshold][unit]",{threshold:M.eE[t],unit:i});case M.SP.MEH:return Array.isArray(t)?(0,y.t)("Meh"):(0,y._N)("Meh: >[threshold][unit]",{threshold:M.MN[t],unit:i});case M.SP.GOOD:return Array.isArray(t)?(0,y.t)("Good"):(0,y._N)("Good: <[threshold][unit]",{threshold:M.MN[t],unit:i});default:return null}}function E(t){return(0,H.tZ)(F,{children:t.percents.map((e=>(0,H.tZ)(x.Z,{title:L(t.vital,e.vitalState),disabled:t.hideTooltips,children:(0,H.BX)(G,{children:[M.Np[e.vitalState],(0,H.BX)("span",{children:[t.showVitalPercentNames&&(0,y.t)("".concat(e.vitalState))," ",(0,V.rl)(e.percent,0)]})]})},e.vitalState)))})}E.displayName="VitalPercents";const F=(0,n.Z)("div",{target:"ex3thpn1"})("display:inline-grid;grid-auto-flow:column;gap:",(0,b.Z)(2),";"),G=(0,n.Z)("div",{target:"ex3thpn0"})("display:flex;align-items:center;gap:",(0,b.Z)(.5),";font-size:",(t=>t.theme.fontSizeMedium),";");var I=i("./app/views/performance/landing/utils.tsx");function T(t){const{eventView:e,location:i,organization:n,projects:a,frontendOnly:o=!1}=t;if(o&&(0,I.Oo)(a,e)!==I.BY.FRONTEND_PAGELOAD)return null;const r=[j.Zl.FCP,j.Zl.LCP,j.Zl.FID,j.Zl.CLS];return(0,H.tZ)(N.Z,{eventView:e,location:i,orgSlug:n.slug,vitals:r,children:({isLoading:t,vitalsData:a})=>(0,H.tZ)($,{children:r.map((o=>{var r,s,l;const d=(0,M.i4)({orgSlug:n.slug,query:e.generateQueryStringObject(),vitalName:o,projectID:(0,C.qP)(i.query.project)}),c=t?"—":rt(null!==(r=null==a?void 0:a[o])&&void 0!==r?r:null,o),u=(0,H.tZ)(X,{children:(0,H.tZ)(tt,{isLoading:t,vital:o,data:a})});return(0,H.tZ)(p.Z,{to:d,"data-test-id":"vitals-linked-card-".concat(M.a7[o]),children:(0,H.tZ)(it,{title:null!==(s=M.jo[o])&&void 0!==s?s:"",tooltip:null!==(l=P.r[o].description)&&void 0!==l?l:"",value:t?"—":c,chart:u,minHeight:150})},o)}))})})}T.displayName="FrontendCards";const X=(0,n.Z)("div",{target:"e1he14ku9"})("margin-top:",(0,b.Z)(1.5),";");function Q(t){const e=(0,D.Z)(),{eventView:i,location:n,organization:a,functions:r}=t,{query:l}=n,c=i.withColumns(r),p=c.getGlobalSelection(),u=p.datetime.start?(0,S.hC)(p.datetime.start):void 0,m=p.datetime.end?(0,S.hC)(p.datetime.end):void 0,h="string"==typeof l.sparkInterval?l.sparkInterval:(0,d.ZS)({start:u||null,end:m||null,period:p.datetime.period},"low"),v=c.getEventsAPIPayload(n);return(0,H.tZ)(_.Z,{location:n,eventView:c,orgSlug:a.slug,limit:1,referrer:"api.performance.vitals-cards",children:({isLoading:t,tableData:i})=>(0,H.tZ)(s.Z,{api:e,organization:a,period:p.datetime.period,project:p.projects,environment:p.environments,team:v.team,start:u,end:m,interval:h,query:v.query,includePrevious:!1,yAxis:c.getFields(),partial:!0,children:({results:e})=>{const n=null==e?void 0:e.reduce(((t,e)=>(t[e.seriesName]=e.data.map((t=>t.value)),t)),{}),s=(0,I.hv)(a);return(0,H.tZ)($,{children:r.map((e=>{var a,r;let l=(0,j.sN)(e);l.includes("apdex")&&(l="apdex()");const d=s[l];if(!d)return o.uT("Missing field '".concat(l,"' in vital cards.")),null;const{title:c,tooltip:p,formatter:u}=d,m=(0,j.LY)(l),h=null==i||null===(a=i.data)||void 0===a||null===(r=a[0])||void 0===r?void 0:r[m],v=null==n?void 0:n[l],g=t||!(0,k.ri)(h)?"—":u(h),f=(0,H.tZ)(U,{data:v});return(0,H.tZ)(it,{title:c,tooltip:p,value:g,chart:f,horizontal:!0,minHeight:96,isNotInteractive:!0},l)}))})}})})}function R(t){return(0,H.tZ)(Q,{...t,functions:[{kind:"function",function:["p75","transaction.duration",void 0,void 0]},{kind:"function",function:["tpm","",void 0,void 0]},{kind:"function",function:["failure_rate","",void 0,void 0]},{kind:"function",function:["apdex","",void 0,void 0]}]})}Q.displayName="GenericCards",R.displayName="_BackendCards";const W=R;function Y(t){const e=[{kind:"function",function:["p75","measurements.app_start_cold",void 0,void 0]},{kind:"function",function:["p75","measurements.app_start_warm",void 0,void 0]}];return t.showStallPercentage?e.push({kind:"function",function:["p75","measurements.stall_percentage",void 0,void 0]}):(e.push({kind:"function",function:["p75","measurements.frames_slow_rate",void 0,void 0]}),e.push({kind:"function",function:["p75","measurements.frames_frozen_rate",void 0,void 0]})),(0,H.tZ)(Q,{...t,functions:e})}Y.displayName="_MobileCards";const J=Y;function U(t){const{data:e}=t,i=A.ZP.charts.getColorPalette(1)[0];return(0,H.tZ)(K,{"data-test-id":"sparkline",width:150,height:24,children:(0,H.tZ)(Z,{data:e,width:150,height:24,children:(0,H.tZ)(v.SparklinesLine,{style:{stroke:i,fill:"none",strokeWidth:3}})})})}U.displayName="SparklineChart";const K=(0,n.Z)("div",{target:"e1he14ku8"})("flex-grow:4;max-height:",(t=>t.height),"px;max-width:",(t=>t.width),"px;margin:",(0,b.Z)(1)," ",(0,b.Z)(0)," ",(0,b.Z)(.5)," ",(0,b.Z)(3),";"),$=(0,n.Z)("div",{target:"e1he14ku7"})("display:grid;grid-template-columns:1fr;grid-column-gap:",(0,b.Z)(2),";@media (min-width: ",(t=>t.theme.breakpoints[0]),"){grid-template-columns:repeat(2, 1fr);}@media (min-width: ",(t=>t.theme.breakpoints[2]),"){grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));}");function tt(t){var e;const{isLoading:i,data:n,vital:o,value:r,showBar:s=!0,showStates:l=!1,showDurationDetail:d=!1,showVitalPercentNames:c=!1,showDetail:p=!0,showTooltip:m=!1,barHeight:h}=t;if(i)return l?(0,H.tZ)(u.Z,{height:"48px"}):null;const v=l?(0,H.tZ)(et,{small:!0,children:(0,y.t)("No vitals found")}):null;if(!n)return v;const g={poor:0,meh:0,good:0,total:0};if((Array.isArray(o)?o:[o]).forEach((t=>{var e;const i=null!==(e=null==n?void 0:n[t])&&void 0!==e?e:{};Object.keys(g).forEach((t=>g[t]+=i[t]))})),!g.total)return v;const f=Array.isArray(o)?null:null!=r?r:rt(null!==(e=null==n?void 0:n[o])&&void 0!==e?e:null,o),Z=function({poor:t,meh:e,good:i,total:n}){const a=t/n,o=e/n,r=i/n;return[{vitalState:M.SP.GOOD,percent:r},{vitalState:M.SP.MEH,percent:o},{vitalState:M.SP.POOR,percent:a}]}(g),x=function(t){return t.map((({percent:t,vitalState:e})=>({percent:t,color:M.fL[e]})))}(Z);return(0,H.BX)(a.Fragment,{children:[s&&(0,H.tZ)(ot,{title:(0,H.tZ)(E,{vital:o,percents:Z,showVitalPercentNames:!0,hideTooltips:m}),disabled:!m,position:"bottom",children:(0,H.tZ)(B,{barHeight:h,colorStops:x})}),p&&(0,H.BX)(st,{children:[d&&f&&(0,H.BX)("div",{"data-test-id":"vital-bar-p75",children:[(0,y.t)("The p75 for all transactions is "),(0,H.tZ)("strong",{children:f})]}),(0,H.tZ)(E,{vital:o,percents:Z,showVitalPercentNames:c})]})]})}tt.displayName="VitalBar";const et=(0,n.Z)(c.Z,{target:"e1he14ku6"})("height:48px;padding:",(0,b.Z)(1.5)," 15%;");function it(t){const{chart:e,minHeight:i,horizontal:n,title:a,tooltip:o,value:r,isNotInteractive:s}=t;return(0,H.BX)(at,{interactive:!s,minHeight:i,children:[(0,H.BX)(l.Gh,{children:[(0,H.tZ)(dt,{children:(0,y.t)(a)}),(0,H.tZ)(m.Z,{size:"sm",position:"top",title:o})]}),(0,H.BX)(nt,{horizontal:n,children:[(0,H.tZ)(lt,{children:r}),e]})]})}it.displayName="VitalCard";const nt=(0,n.Z)("div",{target:"e1he14ku5"})("width:100%;display:flex;flex-direction:",(t=>t.horizontal?"row":"column"),";justify-content:space-between;"),at=(0,n.Z)(r.Z,{target:"e1he14ku4"})("color:",(t=>t.theme.textColor),";padding:",(0,b.Z)(2)," ",(0,b.Z)(3),";align-items:flex-start;margin-bottom:",(0,b.Z)(2),";",(t=>t.minHeight&&"min-height: ".concat(t.minHeight,"px")),";"),ot=(0,n.Z)(x.Z,{target:"e1he14ku3"})({name:"1d3w5wq",styles:"width:100%"});function rt(t,e){var i;const n=null!==(i=null==t?void 0:t.p75)&&void 0!==i?i:null;return null===n?"—":e===j.Zl.CLS?n.toFixed(2):"".concat(n.toFixed(0),"ms")}const st=(0,n.Z)("div",{target:"e1he14ku2"})("font-size:",(t=>t.theme.fontSizeMedium),";@media (min-width: ",(t=>t.theme.breakpoints[0]),"){display:flex;justify-content:space-between;}"),lt=(0,n.Z)("div",{target:"e1he14ku1"})("font-size:32px;margin-top:",(0,b.Z)(1),";"),dt=(0,n.Z)("div",{target:"e1he14ku0"})(w.Z,";")}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_landing_vitalsCards_tsx.0a7e27ffeac18976170c6b79d173ad70.js.map