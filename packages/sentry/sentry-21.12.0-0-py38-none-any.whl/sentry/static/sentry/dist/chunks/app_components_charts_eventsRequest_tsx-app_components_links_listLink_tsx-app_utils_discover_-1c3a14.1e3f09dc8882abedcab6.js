"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_components_charts_eventsRequest_tsx-app_components_links_listLink_tsx-app_utils_discover_-1c3a14"],{"./app/actionCreators/events.tsx":(e,t,s)=>{s.d(t,{lI:()=>l,eV:()=>c,JE:()=>d}),s("../node_modules/core-js/modules/es.object.from-entries.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var a=s("../node_modules/lodash/pick.js"),r=s.n(a),n=s("./app/components/charts/utils.tsx"),i=s("./app/utils/getPeriod.tsx"),o=s("./app/utils/performance/constants.tsx");const l=(e,{organization:t,project:s,environment:a,team:r,period:o,start:l,end:c,interval:d,comparisonDelta:u,includePrevious:p,query:m,yAxis:v,field:h,topEvents:g,orderby:f,partial:x,withoutZerofill:y,referrer:Z,queryBatching:b})=>{const D=(0,n.Sw)(p,o),w={query:{...Object.fromEntries(Object.entries({interval:d,comparisonDelta:u,project:s,environment:a,team:r,query:m,yAxis:v,field:h,topEvents:g,orderby:f,partial:x?"1":void 0,withoutZerofill:y?"1":void 0,referrer:Z||"api.organization-event-stats"}).filter((([,e])=>void 0!==e))),...(0,i.X)({period:o,start:l,end:c},{shouldDoublePeriod:D})}},j="/organizations/".concat(t.slug,"/events-stats/");return null!=b&&b.batchRequest?b.batchRequest(e,j,w):e.requestPromise(j,w)};async function c(e,t,s){const a={...r()(s,Object.values(o.s)),query:s.query};return e.requestPromise("/organizations/".concat(t,"/events-facets/"),{query:a})}async function d(e,t,s){const a={...r()(s,Object.values(o.s)),query:s.query};return e.requestPromise("/organizations/".concat(t,"/events-meta/"),{query:a}).then((e=>e.count))}},"./app/components/charts/eventsRequest.tsx":(e,t,s)=>{s.d(t,{Z:()=>y});var a=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),n=s("../node_modules/lodash/isEqual.js"),i=s.n(n),o=s("../node_modules/lodash/omitBy.js"),l=s.n(o),c=s("./app/actionCreators/events.tsx"),d=s("./app/actionCreators/indicator.tsx"),u=s("./app/components/charts/loadingPanel.tsx"),p=s("./app/components/charts/utils.tsx"),m=s("./app/locale.tsx"),v=s("./app/utils/discover/fields.tsx"),h=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const g=["api","children","organization","loading","queryBatching"],f=e=>l()(e,((e,t)=>g.includes(t)));class x extends r.PureComponent{constructor(...e){super(...e),(0,a.Z)(this,"state",{reloading:!!this.props.loading,errored:!1,timeseriesData:null,fetchedWithPrevious:!1}),(0,a.Z)(this,"unmounting",!1),(0,a.Z)(this,"fetchData",(async()=>{const{api:e,confirmedQuery:t,expired:s,name:a,hideError:r,...n}=this.props;let i,o=null;if(!1!==t){if(this.setState((e=>({reloading:null!==e.timeseriesData,errored:!1,errorMessage:void 0}))),s)i=(0,m.t)("%s has an invalid date range. Please try a more recent date range.",a),(0,d.Iw)(i,{append:!0}),this.setState({errored:!0,errorMessage:i});else try{e.clear(),o=await(0,c.lI)(e,n)}catch(e){i=e&&e.responseJSON&&e.responseJSON.detail?e.responseJSON.detail:(0,m.t)("Error loading chart data"),r||(0,d.Iw)(i),this.setState({errored:!0,errorMessage:i})}this.unmounting||this.setState({reloading:!1,timeseriesData:o,fetchedWithPrevious:n.includePrevious})}})),(0,a.Z)(this,"getData",(e=>{const{fetchedWithPrevious:t}=this.state,{period:s,includePrevious:a}=this.props,r=t||(0,p.Sw)(a,s),n=Math.floor(e.length/2);return{current:r?e.slice(n):e,previous:r?e.slice(0,n):null}}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){i()(f(e),f(this.props))||this.fetchData()}componentWillUnmount(){this.unmounting=!0}calculateTotalsPerTimestamp(e,t=(e=>1e3*e)){return e.map((([e,s],a)=>({name:t(e,s,a),value:s.reduce(((e,{count:t})=>e+t),0)})))}transformPreviousPeriodData(e,t,s){return t?{seriesName:null!=s?s:"Previous",data:this.calculateTotalsPerTimestamp(t,((t,s,a)=>1e3*e[a][0])),stack:"previous"}:null}transformAggregatedTimeseries(e,t=""){return{seriesName:t,data:this.calculateTotalsPerTimestamp(e)}}transformTimeseriesData(e,t){return[{seriesName:t||"Current",data:e.map((([e,t])=>({name:1e3*e,value:t.reduce(((e,{count:t})=>e+t),0)})))}]}transformComparisonTimeseriesData(e){return[{seriesName:"comparisonCount()",data:e.map((([e,t])=>({name:1e3*e,value:t.reduce(((e,{comparisonCount:t})=>e+(null!=t?t:0)),0)})))}]}processData(e,t=0,s){var a;const{data:r,totals:n}=e,{includeTransformedData:i,includeTimeAggregation:o,timeAggregationSeriesName:l,currentSeriesNames:c,previousSeriesNames:d,comparisonDelta:u}=this.props,{current:p,previous:m}=this.getData(r);return{data:i?this.transformTimeseriesData(p,null!=s?s:null==c?void 0:c[t]):[],comparisonData:i&&u?this.transformComparisonTimeseriesData(p):[],allData:r,originalData:p,totals:n,originalPreviousData:m,previousData:i?this.transformPreviousPeriodData(p,m,null!==(a=s?"previous ".concat(s):void 0)&&void 0!==a?a:null==d?void 0:d[t]):null,timeAggregatedData:o?this.transformAggregatedTimeseries(p,l||""):{},timeframe:e.start&&e.end?m?{start:500*(e.start+e.end),end:1e3*e.end}:{start:1e3*e.start,end:1e3*e.end}:void 0}}render(){const{children:e,showLoading:t,...s}=this.props,{timeseriesData:a,reloading:r,errored:n,errorMessage:i}=this.state,o=this.props.loading||null===a;if(t&&o)return(0,h.tZ)(u.Z,{"data-test-id":"events-request-loading"});if((0,p.Xe)(a)){let t;const l=Object.keys(a).map(((e,s)=>{const r=a[e],n=this.processData(r,s,(0,v.bQ)(e));return t||(t=n.timeframe),[r.order||0,n.data[0],n.previousData]})).sort(((e,t)=>e[0]-t[0])),c=l.map((e=>e[1])),d=l.some((e=>null===e[2]))?void 0:l.map((e=>e[2]));return e({loading:o,reloading:r,errored:n,errorMessage:i,results:c,timeframe:t,previousTimeseriesData:d,...s})}if(a){const{data:t,comparisonData:l,allData:c,originalData:d,totals:u,originalPreviousData:p,previousData:m,timeAggregatedData:v,timeframe:h}=this.processData(a);return e({loading:o,reloading:r,errored:n,errorMessage:i,timeseriesData:t,comparisonTimeseriesData:l,allTimeseriesData:c,originalTimeseriesData:d,timeseriesTotals:u,originalPreviousTimeseriesData:p,previousTimeseriesData:m?[m]:m,timeAggregatedData:v,timeframe:h,...s})}return e({loading:o,reloading:r,errored:n,errorMessage:i,...s})}}x.displayName="EventsRequest",(0,a.Z)(x,"defaultProps",{period:void 0,start:null,end:null,interval:"1d",comparisonDelta:void 0,limit:15,query:"",includePrevious:!0,includeTransformedData:!0});const y=x},"./app/components/charts/transparentLoadingMask.tsx":(e,t,s)=>{s.d(t,{Z:()=>i});var a=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=(s("../node_modules/react/index.js"),s("./app/components/loadingMask.tsx")),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const i=(0,a.Z)((({className:e,visible:t,children:s,...a})=>{const i=t?{...a,"data-test-id":"loading-placeholder"}:a;return(0,n.tZ)(r.Z,{className:e,...i,children:s})}),{target:"ewtkxp50"})((e=>!e.visible&&"display: none;"),";opacity:0.4;z-index:1;")},"./app/components/discover/discoverFeature.tsx":(e,t,s)=>{s.d(t,{Z:()=>c}),s("../node_modules/react/index.js");var a=s("./app/components/acl/feature.tsx"),r=s("./app/components/acl/featureDisabled.tsx"),n=s("./app/components/hovercard.tsx"),i=s("./app/locale.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function l({children:e}){const t=(0,i.t)("Requires discover feature.");return(0,o.tZ)(a.Z,{hookName:"feature-disabled:open-discover",features:["organizations:discover-basic"],renderDisabled:e=>(0,o.tZ)(n.ZP,{body:(0,o.tZ)(r.Z,{features:e.features,hideHelpToggle:!0,message:t,featureName:t}),children:e.children(e)}),children:({hasFeature:t})=>e({hasFeature:t})})}l.displayName="DiscoverFeature";const c=l},"./app/components/discoverButton.tsx":(e,t,s)=>{s.d(t,{Z:()=>o}),s("../node_modules/react/index.js");var a=s("./app/components/button.tsx"),r=s("./app/components/discover/discoverFeature.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i({children:e,...t}){return(0,n.tZ)(r.Z,{children:({hasFeature:s})=>(0,n.tZ)(a.ZP,{disabled:!s,...t,children:e})})}i.displayName="DiscoverButton";const o=i},"./app/components/links/listLink.tsx":(e,t,s)=>{s.d(t,{Z:()=>v});var a=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),i=s("../node_modules/react-router/es/index.js"),o=s("../node_modules/classnames/index.js"),l=s.n(o),c=s("../node_modules/lodash/omit.js"),d=s.n(c),u=s("../node_modules/query-string/index.js"),p=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class m extends n.Component{constructor(...e){super(...e),(0,a.Z)(this,"getClassName",(()=>{const e={},{className:t,activeClassName:s}=this.props;return t&&(e[t]=!0),this.isActive()&&s&&(e[s]=!0),l()(e)}))}isActive(){const{isActive:e,to:t,query:s,index:a,router:r}=this.props,n=s?u.parse(s):void 0,i="string"==typeof t?{pathname:t,query:n}:t;return"function"==typeof e?e(i,a):r.isActive(i,a)}render(){const{index:e,children:t,to:s,disabled:a,...r}=this.props,n=d()(r,"activeClassName","css","isActive","index","router","location");return(0,p.tZ)(h,{className:this.getClassName(),disabled:a,children:(0,p.tZ)(i.Link,{...n,onlyActiveOnIndex:e,to:a?"":s,children:t})})}}m.displayName="ListLink",(0,a.Z)(m,"displayName","ListLink"),(0,a.Z)(m,"defaultProps",{activeClassName:"active",index:!1,disabled:!1});const v=(0,i.withRouter)(m),h=(0,r.Z)("li",{shouldForwardProp:e=>"disabled"!==e,target:"er8tqc10"})((e=>e.disabled&&"\n   a {\n    color:".concat(e.theme.disabled," !important;\n    pointer-events: none;\n    :hover {\n      color: ").concat(e.theme.disabled,"  !important;\n    }\n   }\n")),";")},"./app/utils/discover/discoverQuery.tsx":(e,t,s)=>{s.d(t,{Z:()=>l}),s("../node_modules/react/index.js");var a=s("./app/utils/withApi.tsx"),r=s("./app/utils/discover/genericDiscoverQuery.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e,t){return e.transactionName!==t.transactionName||e.transactionThreshold!==t.transactionThreshold||e.transactionThresholdMetric!==t.transactionThresholdMetric}function o(e){return(0,n.tZ)(r.ZP,{route:"eventsv2",shouldRefetchData:i,...e})}o.displayName="DiscoverQuery";const l=(0,a.Z)(o)},"./app/utils/getPeriod.tsx":(e,t,s)=>{s.d(t,{X:()=>o}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var a=s("../node_modules/moment/moment.js"),r=s.n(a),n=s("./app/constants/index.tsx"),i=s("./app/utils/dates.tsx");const o=({period:e,start:t,end:s},{shouldDoublePeriod:a}={})=>{if(e||t||s||(e=n.GY),e){if(!a)return{statsPeriod:e};const[,t,s]=e.match(/([0-9]+)([mhdw])/);return{statsPeriod:"".concat(2*parseInt(t,10)).concat(s)}}if(!t||!s)throw new Error("start and end required");const o=(0,i.v5)(t),l=(0,i.v5)(s);if(a){const e=r()(s).diff(r()(t)),a=r()(t).subtract(e);return{start:(0,i.v5)(a),end:l}}return{start:o,end:l}}},"./app/views/performance/transactionSummary/transactionEvents/utils.tsx":(e,t,s)=>{s.d(t,{q3:()=>o,_S:()=>l,xr:()=>c,tb:()=>d,qg:()=>u,Zq:()=>p});var a=s("./app/locale.tsx"),r=s("./app/utils/queryString.tsx"),n=s("./app/views/performance/transactionSummary/filter.tsx"),i=s("./app/views/performance/transactionSummary/utils.tsx");let o;function l(e,t){const{p99:s,p95:r,p75:i,p50:l}=t||{p99:0,p95:0,p75:0,p50:0};return{[o.p50]:{name:o.p50,query:l?[["transaction.duration","<=".concat(l.toFixed(0))]]:void 0,sort:{kind:"desc",field:(0,n.T$)(e)||"transaction.duration"},label:(0,a.t)("p50")},[o.p75]:{name:o.p75,query:i?[["transaction.duration","<=".concat(i.toFixed(0))]]:void 0,sort:{kind:"desc",field:(0,n.T$)(e)||"transaction.duration"},label:(0,a.t)("p75")},[o.p95]:{name:o.p95,query:r?[["transaction.duration","<=".concat(r.toFixed(0))]]:void 0,sort:{kind:"desc",field:(0,n.T$)(e)||"transaction.duration"},label:(0,a.t)("p95")},[o.p99]:{name:o.p99,query:s?[["transaction.duration","<=".concat(s.toFixed(0))]]:void 0,sort:{kind:"desc",field:(0,n.T$)(e)||"transaction.duration"},label:(0,a.t)("p99")},[o.p100]:{name:o.p100,label:(0,a.t)("p100")}}}function c({orgSlug:e,transaction:t,projectID:s,query:a}){return{pathname:"/organizations/".concat(e,"/performance/summary/events/"),query:{transaction:t,project:s,environment:a.environment,statsPeriod:a.statsPeriod,start:a.start,end:a.end,query:a.query}}}function d(e){return t=(0,r.ro)(e.query.showTransactions,o.p100),Object.values(o).includes(t)?t:o.p100;var t}function u(e,t){var s,a;const r=l(t),n=null===(s=r[e].sort)||void 0===s?void 0:s.kind,i=null===(a=r[e].sort)||void 0===a?void 0:a.field,o={showTransactions:e};return n&&i&&(o.sort="".concat("desc"===n?"-":"").concat(i)),o}function p(e){switch(e){case i.K0.OUTLIER:return o.p100;case i.K0.SLOW:return o.p95;default:return}}!function(e){e.p50="p50",e.p75="p75",e.p95="p95",e.p99="p99",e.p100="p100"}(o||(o={}))},"./app/views/performance/transactionSummary/transactionVitals/constants.tsx":(e,t,s)=>{s.d(t,{sE:()=>i,GW:()=>o,PE:()=>d,QB:()=>u}),s("../node_modules/core-js/modules/es.array.reverse.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var a=s("./app/utils/discover/fields.tsx"),r=s("./app/utils/performance/vitals/constants.tsx"),n=s("./app/utils/theme.tsx");const i=100,o=.75,l=[{vitals:[a.Zl.FP,a.Zl.FCP,a.Zl.LCP],min:0},{vitals:[a.Zl.FID],min:0,precision:2},{vitals:[a.Zl.CLS],min:0,precision:2}],c=[...n.ZP.charts.getColorPalette(l.reduce(((e,{vitals:t})=>e+t.length),0)-1)].reverse(),d=l.map((e=>({...e,colors:c.splice(0,e.vitals.length)}))),u=l.reduce(((e,{vitals:t})=>(t.forEach((t=>{const s=r.r[t].slug;e.push("".concat(s,"Start")),e.push("".concat(s,"End"))})),e)),[])},"./app/views/performance/transactionSummary/transactionVitals/index.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>xe}),s("../node_modules/core-js/modules/es.string.trim.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var a=s("./app/locale.tsx"),r=s("./app/utils/discover/eventView.tsx"),n=s("./app/utils/discover/fields.tsx"),i=s("./app/utils/performance/vitals/constants.tsx"),o=s("./app/utils/queryString.tsx"),l=s("./app/utils/tokenizeSearch.tsx"),c=s("./app/utils/withOrganization.tsx"),d=s("./app/utils/withProjects.tsx"),u=s("./app/views/performance/transactionSummary/pageLayout.tsx"),p=s("./app/views/performance/transactionSummary/tabs.tsx"),m=s("./app/views/performance/transactionSummary/transactionVitals/constants.tsx"),v=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),h=s("../node_modules/react-router/es/index.js"),g=s("./app/components/button.tsx"),f=s("./app/components/dropdownControl.tsx"),x=s("./app/components/events/searchBar.tsx"),y=s("./app/components/layouts/thirds.tsx"),Z=s("./app/components/organizations/globalSelectionHeader/getParams.tsx"),b=s("./app/styles/space.tsx"),D=s("./app/utils/analytics.tsx"),w=s("./app/utils/performance/histogram/index.tsx"),j=s("./app/utils/performance/histogram/constants.tsx"),P=s("../node_modules/react/index.js"),_=s("./app/components/panels/index.tsx"),S=s("./app/utils/performance/histogram/histogramQuery.tsx"),q=s("./app/utils/performance/vitals/vitalsCardsDiscoverQuery.tsx"),k=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),C=(s("../node_modules/core-js/modules/es.symbol.description.js"),s("../node_modules/@emotion/react/dist/emotion-element-a8309070.browser.esm.js")),z=s("../node_modules/lodash/isEqual.js"),V=s.n(z),T=s("../node_modules/lodash/throttle.js"),N=s.n(T),F=s("./app/components/charts/barChart.tsx"),E=s("./app/components/charts/barChartZoom.tsx"),L=s("./app/components/charts/components/markLine.tsx"),R=s("./app/components/charts/transparentLoadingMask.tsx"),O=s("./app/components/charts/utils.tsx"),A=s("./app/components/discoverButton.tsx"),M=s("./app/components/placeholder.tsx"),B=s("./app/utils/formatters.tsx"),W=s("./app/utils/getDynamicText.tsx"),I=s("./app/utils/performance/histogram/utils.tsx"),Q=s("./app/views/performance/transactionSummary/transactionEvents/utils.tsx"),G=s("./app/views/performance/landing/vitalsCards.tsx"),K=s("./app/views/performance/vitalDetail/utils.tsx"),X=s("./app/components/charts/styles.tsx");const H=(0,v.Z)(_.Lv,{target:"e1l3pu0z5"})({name:"1slq3zi",styles:"display:grid;grid-template-columns:325px minmax(100px, auto);padding:0"}),U=(0,v.Z)("div",{target:"e1l3pu0z4"})("padding:",(0,b.Z)(3),";"),J=(0,v.Z)(U,{target:"e1l3pu0z3"})("position:relative;border-right:1px solid ",(e=>e.theme.border),";grid-column:1/1;display:flex;flex-direction:column;justify-content:space-between;"),$=(0,v.Z)(X.OT,{target:"e1l3pu0z2"})({name:"cfjpzu",styles:"margin:0px"}),Y=(0,v.Z)("div",{target:"e1l3pu0z1"})("font-size:",(e=>e.theme.fontSizeMedium),";color:",(e=>e.theme.subText),";"),ee=(0,v.Z)("div",{target:"e1l3pu0z0"})({name:"5r9nha",styles:"font-size:32px"});var te=s("./app/views/performance/transactionSummary/transactionVitals/utils.tsx"),se=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class ae extends P.Component{constructor(...e){super(...e),(0,k.Z)(this,"state",{refDataRect:null,refPixelRect:null}),(0,k.Z)(this,"trackOpenInDiscoverClicked",(()=>{const{organization:e}=this.props,{vitalDetails:t}=this.props;(0,D.ec)({eventKey:"performance_views.vitals.open_in_discover",eventName:"Performance Views: Open vitals in discover",organization_id:e.id,vital:t.slug})})),(0,k.Z)(this,"trackOpenAllEventsClicked",(()=>{const{organization:e}=this.props,{vitalDetails:t}=this.props;(0,D.ec)({eventKey:"performance_views.vitals.open_all_events",eventName:"Performance Views: Open vitals in all events",organization_id:e.id,vital:t.slug})})),(0,k.Z)(this,"handleRendered",N()(((e,t)=>{const{chartData:s}=this.props,{refDataRect:a}=this.state;if(null===a||s.length<1)return;const r=null===a?null:(0,te.L0)(t,a);null===r||V()(r,this.state.refPixelRect)||this.setState({refPixelRect:r})}),200,{leading:!0})),(0,k.Z)(this,"handleDataZoomCancelled",(()=>{}))}static getDerivedStateFromProps(e,t){const{isLoading:s,error:a,chartData:r}=e;if(s||null===a)return{...t};const n=(0,te.eH)(r);return null===t.refDataRect||null!==n&&!V()(n,t.refDataRect)?{...t,refDataRect:n}:{...t}}get summary(){var e;const{summaryData:t}=this.props;return null!==(e=null==t?void 0:t.p75)&&void 0!==e?e:null}get failureRate(){var e,t;const{summaryData:s}=this.props,a=null!==(e=null==s?void 0:s.poor)&&void 0!==e?e:0,r=null!==(t=null==s?void 0:s.total)&&void 0!==t?t:0;return r<=0?0:a/r}getFormattedStatNumber(){const{vitalDetails:e}=this.props,t=this.summary,{type:s}=e;return null===t?"—":"duration"===s?(0,B.g9)(t/1e3,2,!0):(0,B.$1)(t,2)}renderSummary(){var e;const{vitalDetails:t,eventView:s,organization:r,min:i,max:o,dataFilter:c}=this.props,{slug:d,name:u,description:p}=t,v=r.features.includes("performance-events-page"),h="measurements.".concat(d),f=s.withColumns([{kind:"field",field:"transaction"},{kind:"function",function:["percentile",h,m.GW.toString(),void 0]},{kind:"function",function:["count","","",void 0]}]).withSorts([{kind:"desc",field:(0,n.LY)("percentile(".concat(h,",").concat(m.GW.toString(),")"))}]),x=new l.MY(null!==(e=f.query)&&void 0!==e?e:"");return x.addFilterValues("has",[h]),void 0===i&&void 0===o||(void 0!==i&&x.addFilterValues(h,[">=".concat(i)]),void 0!==o&&x.addFilterValues(h,["<=".concat(o)])),f.query=x.formatString(),(0,se.BX)(J,{children:[(0,se.tZ)(re,{children:(0,se.tZ)($,{children:"".concat(u," (").concat(d.toUpperCase(),")")})}),(0,se.tZ)(ee,{children:(0,W.Z)({value:this.getFormattedStatNumber(),fixed:"—"})}),(0,se.tZ)(Y,{children:p}),(0,se.tZ)("div",{children:v?(0,se.tZ)(g.ZP,{size:"small",to:f.withColumns([{kind:"field",field:h}]).withSorts([{kind:"desc",field:h}]).getPerformanceTransactionEventsViewUrlTarget(r.slug,{showTransactions:"all"===c?Q.q3.p100:Q.q3.p75,webVital:h}),onClick:this.trackOpenAllEventsClicked,children:(0,a.t)("View All Events")}):(0,se.tZ)(A.Z,{size:"small",to:f.getResultsViewUrlTarget(r.slug),onClick:this.trackOpenInDiscoverClicked,children:(0,a.t)("Open in Discover")})})]})}renderHistogram(){const{theme:e,location:t,isLoading:s,chartData:a,summaryData:r,error:n,colors:i,vital:o,vitalDetails:l,precision:c=0}=this.props,{slug:d}=l,u=this.getSeries(),p={type:"category",truncate:!0,axisTick:{alignWithLabel:!0}},v=u.data.map((e=>e.value)),h={type:"value",max:v.length?Math.max(...v):void 0,axisLabel:{color:e.chartLabel,formatter:B.Du}},g=[u];if(!s&&!n){const e=this.getBaselineSeries();null!==e&&g.push(e)}const f=s||n||null===r?{}:{[o]:r};return(0,se.tZ)(E.Z,{minZoomWidth:10**-c*m.sE,location:t,paramStart:"".concat(d,"Start"),paramEnd:"".concat(d,"End"),xAxisIndex:[0],buckets:(0,I._W)(a),onDataZoomCancelled:this.handleDataZoomCancelled,children:e=>(0,se.BX)(ne,{children:[(0,se.tZ)(R.Z,{visible:s}),(0,se.tZ)(ie,{children:(0,se.tZ)(G.JO,{isLoading:s,data:f,vital:o,showBar:!1,showStates:!1,showVitalPercentNames:!1,showDurationDetail:!1})}),(0,W.Z)({value:(0,se.tZ)(F.Z,{series:g,xAxis:p,yAxis:h,colors:i,onRendered:this.handleRendered,grid:{left:(0,b.Z)(3),right:(0,b.Z)(3),top:(0,b.Z)(3),bottom:(0,b.Z)(1.5)},stacked:!0,...e}),fixed:(0,se.tZ)(M.Z,{testId:"skeleton-ui",height:"200px"})})]})})}bucketWidth(){const{chartData:e}=this.props;return e.length>=2?e[1].bin-e[0].bin:0}getSeries(){const{theme:e,chartData:t,precision:s,vitalDetails:r,vital:n}=this.props,i=(0,I.GT)(t,{precision:0===s?void 0:s,type:r.type,additionalFieldsFn:t=>({itemStyle:{color:e[this.getVitalsColor(n,t)]}})});return{seriesName:(0,a.t)("Count"),data:i}}getVitalsColor(e,t){const s=K.eE[e],a=K.MN[e];return t>=s?K.fL[K.SP.POOR]:t>=a?K.fL[K.SP.MEH]:K.fL[K.SP.GOOD]}getBaselineSeries(){const{theme:e,chartData:t}=this.props,s=this.summary;if(null===s||null===this.state.refPixelRect)return null;const r=(0,te.oZ)(t,s);if(null===r||-1===r)return null;const n=(0,te.jb)({x:r-.5,y:0},this.state.refDataRect,this.state.refPixelRect);if(null===n)return null;const i=(0,te.jb)({x:r-.5,y:Math.max(...t.map((e=>e.count)))||1},this.state.refDataRect,this.state.refPixelRect);if(null===i)return null;const o=(0,L.Z)({animationDuration:200,data:[[n,i]],label:{show:!1},lineStyle:{color:e.textColor,type:"solid"},tooltip:{formatter:()=>['<div class="tooltip-series tooltip-series-solo">','<span class="tooltip-label">',"<strong>".concat((0,a.t)("p75"),"</strong>"),"</span>","</div>",(0,O.U8)()].join("")}});return{seriesName:(0,a.t)("p75"),data:[],markLine:o}}render(){return(0,se.BX)(H,{children:[this.renderSummary(),this.renderHistogram()]})}}ae.displayName="VitalCard";const re=(0,v.Z)("div",{target:"e1yeyzg42"})({name:"1eoy87d",styles:"display:flex;justify-content:space-between"}),ne=(0,v.Z)("div",{target:"e1yeyzg41"})({name:"bjn8wh",styles:"position:relative"}),ie=(0,v.Z)("div",{target:"e1yeyzg40"})("position:absolute;top:",(0,b.Z)(2),";right:",(0,b.Z)(3),";z-index:2;"),oe=(0,C.b)(ae);class le extends P.Component{renderVitalCard(e,t,s,a,r,n,o,l,c){const{location:d,organization:u,eventView:p,dataFilter:v}=this.props,h=i.r[e],g=void 0!==o||void 0!==l;return(0,se.tZ)(S.Z,{location:d,orgSlug:u.slug,eventView:p,numBuckets:m.sE,fields:g?[e]:[],min:o,max:l,precision:c,dataFilter:v,children:i=>{var m,f;const x=g?i.isLoading:t,y=g?null!==i.error:s,Z=g&&null!==(m=null===(f=i.histograms)||void 0===f?void 0:f[e])&&void 0!==m?m:r;return(0,se.tZ)(oe,{location:d,isLoading:x,error:y,vital:e,vitalDetails:h,summaryData:a,chartData:Z,colors:n,eventView:p,organization:u,min:o,max:l,precision:c,dataFilter:v})}})}renderVitalGroup(e,t){const{location:s,organization:a,eventView:r,dataFilter:n}=this.props,{vitals:l,colors:c,min:d,max:u,precision:p}=e,v=l.reduce(((e,t)=>{const a=i.r[t].slug;return e[t]={start:(0,o.ro)(s.query["".concat(a,"Start")]),end:(0,o.ro)(s.query["".concat(a,"End")])},e}),{});return(0,se.tZ)(S.Z,{location:s,orgSlug:a.slug,eventView:r,numBuckets:m.sE,fields:l,min:d,max:u,precision:p,dataFilter:n,children:e=>{const s=t.isLoading||e.isLoading,a=null!==t.error||null!==e.error;return(0,se.tZ)(P.Fragment,{children:l.map(((r,n)=>{var i,o,l,d,u;const m=null!==(i=null==t||null===(o=t.vitalsData)||void 0===o?void 0:o[r])&&void 0!==i?i:null,h=null!==(l=null===(d=e.histograms)||void 0===d?void 0:d[r])&&void 0!==l?l:[],{start:g,end:f}=null!==(u=v[r])&&void 0!==u?u:{};return(0,se.tZ)(P.Fragment,{children:this.renderVitalCard(r,s,a,m,h,[c[n]],ce(g,p),ce(f,p),p)},r)}))})}})}render(){const{location:e,organization:t,eventView:s}=this.props,a=m.PE.reduce(((e,{vitals:t})=>e.concat(t)),[]);return(0,se.tZ)(_.s_,{children:(0,se.tZ)(q.Z,{eventView:s,orgSlug:t.slug,location:e,vitals:a,children:e=>(0,se.tZ)(P.Fragment,{children:m.PE.map((t=>(0,se.tZ)(P.Fragment,{children:this.renderVitalGroup(t,e)},t.vitals.join(""))))})})})}}function ce(e,t){if(void 0!==e)return void 0===t||0===t?parseInt(e,10):parseFloat(e)}le.displayName="VitalsPanel";const de=le;function ue(e){const{location:t,organization:s,eventView:r}=e,n=(0,o.ro)(t.query.query,""),i=e=>{const s=(0,Z.Q)({...t.query||{},query:e});delete s.cursor,h.browserHistory.push({pathname:t.pathname,query:s})};return(0,se.tZ)(w.Z,{location:t,zoomKeys:m.QB,children:({activeFilter:e,handleFilterChange:o,handleResetView:l,isZoomed:c})=>(0,se.BX)(y.or,{fullWidth:!0,children:[(0,se.BX)(me,{children:[(0,se.tZ)(pe,{organization:s,projectIds:r.project,query:n,fields:r.fields,onSearch:i}),(0,se.tZ)(f.ZP,{buttonProps:{prefix:(0,a.t)("Outliers")},label:e.label,children:j.d.map((({label:t,value:a})=>(0,se.tZ)(f.hP,{onSelect:e=>{(0,D.ec)({eventKey:"performance_views.vitals.filter_changed",eventName:"Performance Views: Change vitals filter",organization_id:s.id,value:e}),o(e)},eventKey:a,isActive:a===e.value,children:t},a)))}),(0,se.tZ)(g.ZP,{onClick:()=>{(0,D.ec)({eventKey:"performance_views.vitals.reset_view",eventName:"Performance Views: Reset vitals view",organization_id:s.id}),l()},disabled:!c,"data-test-id":"reset-view",children:(0,a.t)("Reset View")})]}),(0,se.tZ)(de,{organization:s,location:t,eventView:r,dataFilter:e.value})]})})}ue.displayName="VitalsContent";const pe=(0,v.Z)(x.Z,{target:"ekvr84z1"})({name:"1ff36h2",styles:"flex-grow:1"}),me=(0,v.Z)("div",{target:"ekvr84z0"})("display:grid;grid-gap:",(0,b.Z)(2),";grid-template-columns:auto max-content max-content;align-items:center;margin-bottom:",(0,b.Z)(3),";"),ve=ue;function he(e){const{location:t,organization:s,projects:a}=e;return(0,se.tZ)(u.Z,{location:t,organization:s,projects:a,tab:p.Z.WebVitals,getDocumentTitle:ge,generateEventView:fe,childComponent:ve})}function ge(e){return"string"==typeof e&&String(e).trim().length>0?[String(e).trim(),(0,a.t)("Vitals")].join(" — "):[(0,a.t)("Summary"),(0,a.t)("Vitals")].join(" — ")}function fe(e,t){const s=(0,o.ro)(e.query.query,""),a=new l.MY(s);a.setFilterValues("event.type",["transaction"]).setFilterValues("transaction.op",["pageload"]).setFilterValues("transaction",[t]),Object.keys(a.filters).forEach((e=>{(0,n.h1)(e)&&a.removeFilter(e)}));const c=m.PE.reduce(((e,t)=>e.concat(t.vitals)),[]);return r.ZP.fromNewQueryWithLocation({id:void 0,version:2,name:t,fields:[...c.map((e=>"percentile(".concat(e,", ").concat(m.GW,")"))),...c.map((e=>"count_at_least(".concat(e,", 0)"))),...c.map((e=>"count_at_least(".concat(e,", ").concat(i.r[e].poorThreshold,")")))],query:a.formatString(),projects:[]},e)}he.displayName="TransactionVitals";const xe=(0,d.Z)((0,c.Z)(he))}}]);
//# sourceMappingURL=../sourcemaps/app_components_charts_eventsRequest_tsx-app_components_links_listLink_tsx-app_utils_discover_-1c3a14.d4ff0a1005b722903a04c6555ea7816a.js.map